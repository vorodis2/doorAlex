{"code":"!function(t){var i=window.webpackHotUpdate;window.webpackHotUpdate=function(t,e){!function(t,i){if(!w[t]||!_[t])return;for(var e in _[t]=!1,i)Object.prototype.hasOwnProperty.call(i,e)&&(g[e]=i[e]);0==--x&&0===v&&R()}(t,e),i&&i(t,e)};var e,s=!0,n=\"c332adad2dfdb3e37235\",r=1e4,h={},o=[],a=[];function c(t){var i=B[t];if(!i)return M;var s=function(s){return i.hot.active?(B[s]?-1===B[s].parents.indexOf(t)&&B[s].parents.push(t):(o=[t],e=s),-1===i.children.indexOf(s)&&i.children.push(s)):(console.warn(\"[HMR] unexpected require(\"+s+\") from disposed module \"+t),o=[]),M(s)},n=function(t){return{configurable:!0,enumerable:!0,get:function(){return M[t]},set:function(i){M[t]=i}}};for(var r in M)Object.prototype.hasOwnProperty.call(M,r)&&\"e\"!==r&&\"t\"!==r&&Object.defineProperty(s,r,n(r));return s.e=function(t){return\"ready\"===d&&f(\"prepare\"),v++,M.e(t).then(i,function(t){throw i(),t});function i(){v--,\"prepare\"===d&&(m[t]||P(t),0===v&&0===x&&R())}},s.t=function(t,i){return 1&i&&(t=s(t)),M.t(t,-2&i)},s}function l(t){var i={_acceptedDependencies:{},_declinedDependencies:{},_selfAccepted:!1,_selfDeclined:!1,_disposeHandlers:[],_main:e!==t,active:!0,accept:function(t,e){if(void 0===t)i._selfAccepted=!0;else if(\"function\"==typeof t)i._selfAccepted=t;else if(\"object\"==typeof t)for(var s=0;s<t.length;s++)i._acceptedDependencies[t[s]]=e||function(){};else i._acceptedDependencies[t]=e||function(){}},decline:function(t){if(void 0===t)i._selfDeclined=!0;else if(\"object\"==typeof t)for(var e=0;e<t.length;e++)i._declinedDependencies[t[e]]=!0;else i._declinedDependencies[t]=!0},dispose:function(t){i._disposeHandlers.push(t)},addDisposeHandler:function(t){i._disposeHandlers.push(t)},removeDisposeHandler:function(t){var e=i._disposeHandlers.indexOf(t);e>=0&&i._disposeHandlers.splice(e,1)},check:E,apply:S,status:function(t){if(!t)return d;u.push(t)},addStatusHandler:function(t){u.push(t)},removeStatusHandler:function(t){var i=u.indexOf(t);i>=0&&u.splice(i,1)},data:h[t]};return e=void 0,i}var u=[],d=\"idle\";function f(t){d=t;for(var i=0;i<u.length;i++)u[i].call(null,t)}var p,g,y,x=0,v=0,m={},_={},w={};function b(t){return+t+\"\"===t?+t:t}function E(t){if(\"idle\"!==d)throw new Error(\"check() is only allowed in idle status\");return s=t,f(\"check\"),(i=r,i=i||1e4,new Promise(function(t,e){if(\"undefined\"==typeof XMLHttpRequest)return e(new Error(\"No browser support\"));try{var s=new XMLHttpRequest,r=M.p+\"\"+n+\".hot-update.json\";s.open(\"GET\",r,!0),s.timeout=i,s.send(null)}catch(t){return e(t)}s.onreadystatechange=function(){if(4===s.readyState)if(0===s.status)e(new Error(\"Manifest request to \"+r+\" timed out.\"));else if(404===s.status)t();else if(200!==s.status&&304!==s.status)e(new Error(\"Manifest request to \"+r+\" failed.\"));else{try{var i=JSON.parse(s.responseText)}catch(t){return void e(t)}t(i)}}})).then(function(t){if(!t)return f(\"idle\"),null;_={},m={},w=t.c,y=t.h,f(\"prepare\");var i=new Promise(function(t,i){p={resolve:t,reject:i}});g={};return P(0),\"prepare\"===d&&0===v&&0===x&&R(),i});var i}function P(t){w[t]?(_[t]=!0,x++,function(t){var i=document.createElement(\"script\");i.charset=\"utf-8\",i.src=M.p+\"\"+t+\".\"+n+\".hot-update.js\",document.head.appendChild(i)}(t)):m[t]=!0}function R(){f(\"ready\");var t=p;if(p=null,t)if(s)Promise.resolve().then(function(){return S(s)}).then(function(i){t.resolve(i)},function(i){t.reject(i)});else{var i=[];for(var e in g)Object.prototype.hasOwnProperty.call(g,e)&&i.push(b(e));t.resolve(i)}}function S(i){if(\"ready\"!==d)throw new Error(\"apply() is only allowed in ready status\");var e,s,r,a,c;function l(t){for(var i=[t],e={},s=i.slice().map(function(t){return{chain:[t],id:t}});s.length>0;){var n=s.pop(),r=n.id,h=n.chain;if((a=B[r])&&!a.hot._selfAccepted){if(a.hot._selfDeclined)return{type:\"self-declined\",chain:h,moduleId:r};if(a.hot._main)return{type:\"unaccepted\",chain:h,moduleId:r};for(var o=0;o<a.parents.length;o++){var c=a.parents[o],l=B[c];if(l){if(l.hot._declinedDependencies[r])return{type:\"declined\",chain:h.concat([c]),moduleId:r,parentId:c};-1===i.indexOf(c)&&(l.hot._acceptedDependencies[r]?(e[c]||(e[c]=[]),u(e[c],[r])):(delete e[c],i.push(c),s.push({chain:h.concat([c]),id:c})))}}}}return{type:\"accepted\",moduleId:t,outdatedModules:i,outdatedDependencies:e}}function u(t,i){for(var e=0;e<i.length;e++){var s=i[e];-1===t.indexOf(s)&&t.push(s)}}i=i||{};var p={},x=[],v={},m=function(){console.warn(\"[HMR] unexpected require(\"+E.moduleId+\") to disposed module\")};for(var _ in g)if(Object.prototype.hasOwnProperty.call(g,_)){var E;c=b(_);var P=!1,R=!1,S=!1,H=\"\";switch((E=g[_]?l(c):{type:\"disposed\",moduleId:_}).chain&&(H=\"\\nUpdate propagation: \"+E.chain.join(\" -> \")),E.type){case\"self-declined\":i.onDeclined&&i.onDeclined(E),i.ignoreDeclined||(P=new Error(\"Aborted because of self decline: \"+E.moduleId+H));break;case\"declined\":i.onDeclined&&i.onDeclined(E),i.ignoreDeclined||(P=new Error(\"Aborted because of declined dependency: \"+E.moduleId+\" in \"+E.parentId+H));break;case\"unaccepted\":i.onUnaccepted&&i.onUnaccepted(E),i.ignoreUnaccepted||(P=new Error(\"Aborted because \"+c+\" is not accepted\"+H));break;case\"accepted\":i.onAccepted&&i.onAccepted(E),R=!0;break;case\"disposed\":i.onDisposed&&i.onDisposed(E),S=!0;break;default:throw new Error(\"Unexception type \"+E.type)}if(P)return f(\"abort\"),Promise.reject(P);if(R)for(c in v[c]=g[c],u(x,E.outdatedModules),E.outdatedDependencies)Object.prototype.hasOwnProperty.call(E.outdatedDependencies,c)&&(p[c]||(p[c]=[]),u(p[c],E.outdatedDependencies[c]));S&&(u(x,[E.moduleId]),v[c]=m)}var T,C=[];for(s=0;s<x.length;s++)c=x[s],B[c]&&B[c].hot._selfAccepted&&C.push({module:c,errorHandler:B[c].hot._selfAccepted});f(\"dispose\"),Object.keys(w).forEach(function(t){!1===w[t]&&function(t){delete installedChunks[t]}(t)});for(var D,O,A=x.slice();A.length>0;)if(c=A.pop(),a=B[c]){var j={},z=a.hot._disposeHandlers;for(r=0;r<z.length;r++)(e=z[r])(j);for(h[c]=j,a.hot.active=!1,delete B[c],delete p[c],r=0;r<a.children.length;r++){var L=B[a.children[r]];L&&((T=L.parents.indexOf(c))>=0&&L.parents.splice(T,1))}}for(c in p)if(Object.prototype.hasOwnProperty.call(p,c)&&(a=B[c]))for(O=p[c],r=0;r<O.length;r++)D=O[r],(T=a.children.indexOf(D))>=0&&a.children.splice(T,1);for(c in f(\"apply\"),n=y,v)Object.prototype.hasOwnProperty.call(v,c)&&(t[c]=v[c]);var I=null;for(c in p)if(Object.prototype.hasOwnProperty.call(p,c)&&(a=B[c])){O=p[c];var k=[];for(s=0;s<O.length;s++)if(D=O[s],e=a.hot._acceptedDependencies[D]){if(-1!==k.indexOf(e))continue;k.push(e)}for(s=0;s<k.length;s++){e=k[s];try{e(O)}catch(t){i.onErrored&&i.onErrored({type:\"accept-errored\",moduleId:c,dependencyId:O[s],error:t}),i.ignoreErrored||I||(I=t)}}}for(s=0;s<C.length;s++){var W=C[s];c=W.module,o=[c];try{M(c)}catch(t){if(\"function\"==typeof W.errorHandler)try{W.errorHandler(t)}catch(e){i.onErrored&&i.onErrored({type:\"self-accept-error-handler-errored\",moduleId:c,error:e,originalError:t}),i.ignoreErrored||I||(I=e),I||(I=t)}else i.onErrored&&i.onErrored({type:\"self-accept-errored\",moduleId:c,error:t}),i.ignoreErrored||I||(I=t)}}return I?(f(\"fail\"),Promise.reject(I)):(f(\"idle\"),new Promise(function(t){t(x)}))}var B={};function M(i){if(B[i])return B[i].exports;var e=B[i]={i:i,l:!1,exports:{},hot:l(i),parents:(a=o,o=[],a),children:[]};return t[i].call(e.exports,e,e.exports,c(i)),e.l=!0,e.exports}M.m=t,M.c=B,M.d=function(t,i,e){M.o(t,i)||Object.defineProperty(t,i,{enumerable:!0,get:e})},M.r=function(t){\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(t,\"__esModule\",{value:!0})},M.t=function(t,i){if(1&i&&(t=M(t)),8&i)return t;if(4&i&&\"object\"==typeof t&&t&&t.__esModule)return t;var e=Object.create(null);if(M.r(e),Object.defineProperty(e,\"default\",{enumerable:!0,value:t}),2&i&&\"string\"!=typeof t)for(var s in t)M.d(e,s,function(i){return t[i]}.bind(null,s));return e},M.n=function(t){var i=t&&t.__esModule?function(){return t.default}:function(){return t};return M.d(i,\"a\",i),i},M.o=function(t,i){return Object.prototype.hasOwnProperty.call(t,i)},M.p=\"build/\",M.h=function(){return n},c(8)(M.s=8)}([function(t,i,e){\"use strict\";function s(t){this.parent=t;var i,e=this;this._active=!1,this.RADIUS=1e3,this.POS_X=0,this.POS_Y=0,this.POS_Z=0,this.LINK=\"null\",this.COLOR=\"0xffffff\",this._radius=this.RADIUS,this._link=this.LINK,this._color=this.COLOR,this._shadRotZ=this.parent.ROTATION_Z,this._rotZ=0,this._x=this.POS_X,this._y=this.POS_Y,this._z=this.POS_Z,this.mesh=void 0,this.cont3d=void 0,this.cont3d1=void 0,this.textur=void 0,this.init=function(){null==this.mesh&&(this.geometry=new THREE.SphereGeometry(1,32,32),this.loader=new THREE.TextureLoader,this.loaderHDR=new THREE.RGBELoader,this.material=new THREE.MeshBasicMaterial({side:THREE.BackSide,color:16777215}),this.mesh=new THREE.Mesh(this.geometry,this.material),this.mesh.scale.set(this._radius,this._radius,this._radius),this.cont3d=new THREE.Object3D,this.cont3d1=new THREE.Object3D,this.cont3d.add(this.cont3d1),this.cont3d1.add(this.mesh),this.cont3d1.rotation.y=this._shadRotZ,this.mesh.rotation.y=this._rotZ,this.cont3d.rotation.x=-Math.PI/2)},this.dergActiv=function(){1==this._active?null==this.cont3d.parent&&this.parent.parent.groupObject.add(this.cont3d):null!=this.cont3d.parent&&this.parent.parent.groupObject.remove(this.cont3d)},this.dergLink=function(){\"null\"==this._link?null!=this.material.map&&(this.material.map=null,this.material.needsUpdate=!0):(0==(i=this.checkFormat(this._link))&&this.loader.load(this._link,function(t){e.textur=t,e.material.map=t,e.material.needsUpdate=!0,e.parent.parent.intRend=1}),1==i&&this.loaderHDR.load(this._link,function(t){e.textur=t,e.textur.encoding=THREE.RGBEEncoding,e.textur.minFilter=THREE.NearestFilter,e.textur.magFilter=THREE.NearestFilter,e.textur.flipY=!0,e.material.map=t,e.material.needsUpdate=!0,e.parent.parent.intRend=1}))},this.checkFormat=function(t){return-1!==t.indexOf(\".png\")?0:-1!==t.indexOf(\".jpeg\")?0:-1!==t.indexOf(\".jpg\")?0:t.length>150?-1!==t.indexOf(\"png\")?0:-1!==t.indexOf(\"jpeg\")?0:-1!==t.indexOf(\"jpg\")?0:1:1},this.render=function(){}}e.d(i,\"a\",function(){return s}),s.prototype={set x(t){this._x!==t&&(this._x=t,this.cont3d.position.x=t,this.parent.parent.intRend=1)},get x(){return this._x},set y(t){this._y!==t&&(this._y=t,this.cont3d.position.y=t,this.parent.parent.intRend=1)},get y(){return this._y},set z(t){this._z!==t&&(this._z=t,this.cont3d.position.z=t,this.parent.parent.intRend=1)},get z(){return this._z},set active(t){this._active!==t&&(this._active=t,this.init(),this.dergActiv())},get active(){return this._active},set radius(t){this._radius!==t&&(this._radius=t,null!=this.mesh&&this.mesh.scale.set(this._radius,this._radius,this._radius))},get radius(){return this._radius},set link(t){this._link!==t&&(this._link=t,this.init(),this.dergLink())},get link(){return this._link},set shadRotZ(t){this._shadRotZ!==t&&(this._shadRotZ=t,null!=this.mesh&&(this.cont3d1.rotation.y=this._shadRotZ))},get shadRotZ(){return this._shadRotZ},set rotZ(t){this._rotZ!==t&&(this._rotZ=t,null!=this.mesh&&(this.mesh.rotation.y=this._rotZ))},get rotZ(){return this._rotZ},set color(t){if(this._color!==t){this._color=t,this.init();var i=this._color;if(\"string\"==typeof i&&-1!=i.indexOf(\"x\")){var e=i.split(\"x\");i=\"#\"+e[1]}this.material.color=new THREE.Color(i)}},get color(){return this._color}}},function(t,i,e){\"use strict\";var s=e(4);function n(t,i){for(var e=0;e<i.length;e++){var s=i[e];s.enumerable=s.enumerable||!1,s.configurable=!0,\"value\"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}var r=function(){function t(i){!function(t,i){if(!(t instanceof i))throw new TypeError(\"Cannot call a class as a function\")}(this,t),this.type=\"MenuDiv\";this.dCont=new DCont(i.dCont),this.verhH=50,this.widthBig=i.widthBig,this.otstup=i.otstup,this._sahMenu=i._sahMenu,this.panel=new DPanel(this.dCont,0,0),this.panel.height=this.verhH,this.array=[],this.down=function(){0!=this.idArr?1!=this.idArr?2!=this.idArr||(i.sahMenu=1):i.sahMenu=0:document.location.href=\"https://www.google.com/\"};for(var e=this.widthBig-2*this.otstup,s=0;s<4;s++)this.array[s]=new DButton(this.panel,this.otstup+(e+this.otstup)*s,this.otstup,\" \",this.down),this.array[s].width=e,this.array[s].height=this.verhH-2*this.otstup,this.array[s].idArr=s;this.array[0].loadImeg(\"resources/image/pic1.png\"),this.array[1].text=\"ПЛАН\",this.array[2].text=\"ОБЬЕКТЫ\",this.array[3].text=\"КУПИТЬ\",this.array[1].alpha=.7,this.sizeWindow=function(t,i){this.panel.width=t,this.array[3].x=t-this.otstup-this.array[3].width}}var i,e,s;return i=t,(e=[{key:\"sahMenu\",set:function(t){this._sahMenu!=t&&(this._sahMenu=t,0==this._sahMenu?(this.array[1].alpha=.7,this.array[2].alpha=1):(this.array[1].alpha=1,this.array[2].alpha=.7))},get:function(){return this._sahMenu}}])&&n(i.prototype,e),s&&n(i,s),t}();function h(t){return(h=\"function\"==typeof Symbol&&\"symbol\"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&\"function\"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?\"symbol\":typeof t})(t)}function o(t){return(o=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function a(t,i){return(a=Object.setPrototypeOf||function(t,i){return t.__proto__=i,t})(t,i)}function c(t){if(void 0===t)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return t}function l(t,i){if(!(t instanceof i))throw new TypeError(\"Cannot call a class as a function\")}function u(t,i){for(var e=0;e<i.length;e++){var s=i[e];s.enumerable=s.enumerable||!1,s.configurable=!0,\"value\"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}var d=function(){function t(i){l(this,t),this.type=\"Galleres\";var e=this;this.dC=new DCont(i.dCont),this.dCont=new DCont,this._colorBool=!1,this.verhH=50,this.dC.y=this.verhH,this.widthBig=i.widthBig,this.otstup=i.otstup,this._sahMenu=i._sahMenu,this._index=-1,this.object=null,this.objectBase=i.main.objectBase,this._width=100,this._height=100,this.array=void 0,this.down=function(){0==this.idArr&&(e.index=this.index)},this.wh0=40,this.init=function(){if(null==this.array){this.array=[];for(var t=0;t<3;t++)this.array[t]=new f(this.dCont,0,0,this.down),this.array[t].idArr=t;trace(this.objectBase);var i=this.objectBase.three[0].array;this.array[0].start(i),this.array[0].kolII=1,this.array[0].widthPic=this.wh0,this.array[0].heightPic=this.wh0,this.array[0].width=2*this.otstup+this.wh0,this.array[0].height=this.otstup+(this.wh0+this.otstup)*i.length,this.array[0].panelBool=!0,this.array[0].x=this.otstup+this.widthBig,this.array[0].y=this.otstup,this.array[1].kolII=1,this.array[1].widthPic=this.widthBig-3*this.otstup,this.array[1].heightPic=this.widthBig-3*this.otstup,this.array[1].width=this.widthBig-this.otstup,this.array[1].height=this.widthBig,this.array[1].panelBool=!0,this.array[1].x=this.otstup,this.array[1].y=this.otstup+100,this.array[1].boolPositScrol=!1,this.array[1].scrollBarV.alpha=.5;i=this.objectBase.three[1].array;this.array[2].start(i),this.array[2].kolII=2,this.array[2].widthPic=64-this.otstup/2,this.array[2].heightPic=64-this.otstup/2,this.array[2].width=this.widthBig-this.otstup,this.array[2].height=64+1.5*this.otstup,this.array[2].panelBool=!0,this.array[2].x=this.otstup,this.array[2].y=this.otstup,this.index=0}},this.reDrag=function(){1==this._colorBool?(this.array[2].visible=!0,this.array[1].y=this.array[2].y+this.array[2].height+this.otstup):(this.array[2].visible=!1,this.array[1].y=this.array[2].y);var t=this._height-this.verhH-this.array[1].y-this.otstup;t>this.array[1].scrollBarV.heightContent&&(t=this.array[1].scrollBarV.heightContent),this.array[1].height=t},this.sizeWindow=function(t,i){this._width=t,this._height=i,0!=this._sahMenu&&this.reDrag()}}var i,e,s;return i=t,(e=[{key:\"colorBool\",set:function(t){this._colorBool!=t&&(this._colorBool=t,this.reDrag())},get:function(){return this._colorBool}},{key:\"index\",set:function(t){if(this._index!=t){this._index=t,this.object=null;for(var i=0;i<this.objectBase.three[0].array.length;i++)if(i==this._index){this.object=this.objectBase.three[0].array[i];break}this.array[0].index=this._index,null==this.object?this.array[1].visible=!1:(this.array[1].visible=!0,this.array[1].start(this.object.array),null!=this.object.colorBool&&(this._colorBool=this.object.colorBool)),this.reDrag()}},get:function(){return this._index}},{key:\"sahMenu\",set:function(t){this._sahMenu!=t&&(this._sahMenu=t,1==this._sahMenu?(this.dC.add(this.dCont),this.init(),this.sizeWindow(this._width,this._height)):this.dC.remove(this.dCont))},get:function(){return this._sahMenu}}])&&u(i.prototype,e),s&&u(i,s),t}(),f=function(t){function i(t,e,s,n){var r;l(this,i),(r=function(t,i){return!i||\"object\"!==h(i)&&\"function\"!=typeof i?c(t):i}(this,o(i).call(this))).type=\"GalleryXZ\",null!=t&&null!=t.add&&t.add(c(c(r)));var a=c(c(r));return r.fun=n,r.downBtn=function(){a.index=this.idArr,a.obj=a.array[this.idArr].object,a.fun&&a.fun()},r.createZamen=function(){return new p(this.content,0,0,this.downBtn)},r}return function(t,i){if(\"function\"!=typeof i&&null!==i)throw new TypeError(\"Super expression must either be null or a function\");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),i&&a(t,i)}(i,DGallery),i}();function p(t,i,e,s){DBox.call(this,t,i,e,s),this.type=\"BoxXZ\";var n=this;this.doLink=\"resources/data/\",this.startLoad=function(t){this.object=t;var i=this.doLink+t.id+\"/64.png\";this.image.visible=!0,this.image.link==i?n.funLoad&&n.funLoad():(this.image.width=100,this.image.height=100,this.image.link=i),this.draw()}}function g(t,i){for(var e=0;e<i.length;e++){var s=i[e];s.enumerable=s.enumerable||!1,s.configurable=!0,\"value\"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}p.prototype=Object.create(DBox.prototype),p.prototype.constructor=p,Object.defineProperties(p.prototype,{activ:{set:function(t){this._activ!=t&&(this._activ=t,0==this._activ?this.panel.color1=this._color1:this.panel.color1=this._color)},get:function(){return this._activ}},color:{set:function(t){this._color!=t&&(this._color=t,this.draw())},get:function(){return this._color}},color1:{set:function(t){this._color1!=t&&(this._color1=t)},get:function(){return this._color1}},lineSize:{set:function(t){this._lineSize!=t&&(this._lineSize=t,this.draw())},get:function(){return this._lineSize}},otstup:{set:function(t){this._otstup!=t&&(this._otstup=t,this.draw())},get:function(){return this._otstup}},width:{set:function(t){this._width!=t&&(this._width=t,this.panel.width=this._width,this.draw())},get:function(){return this._width}},height:{set:function(t){this._height!=t&&(this._height=t,this.panel.height=this._height,this.draw())},get:function(){return this._height}}});var y=function(){function t(i,e){!function(t,i){if(!(t instanceof i))throw new TypeError(\"Cannot call a class as a function\")}(this,t),this.type=\"MunuStart\";this.wh=32,this.scane2d=i,this._active=!1,this.content=new PIXI.Container,this.content.visible=!1,i.content.addChild(this.content),this.dCont=new DCont,this._width=100,this._height=100,this.verhH=50,this._sahMenu=0,this.panel,this.dC,this.init=function(){null==this.dC&&(this.dC=new DCont(this.dCont),this.dC.div.style.textAlign=\"center\",this.label=new DLabel(this.dC,0,0,\"lMain.objectBase.arrText[0].ru ,kf ,kf ,kfбла бла бла бла бла бла бла бла бла бла бла бла бла бла бла бла \"),this.label.colorText1=dcmParam.colorText,this.button=new DButton(this.dCont,0,0,\"Далее\",function(){e()}))},this.dragSah=function(){0==this._sahMenu?this.active=!0:this.active=!1},this.sizeWindow=function(t,i){this._width=t,this._height=i,0!=this._active&&(this.label.width=this._width,this.dC.width=this._width,this.button.x=(this._width-this.button.width)/2,this.button.y=this._height-this.button.height-this.wh,this.dC.y=this.button.y-this.label.div.clientHeight-this.wh)}}var i,e,s;return i=t,(e=[{key:\"active\",set:function(t){this._active!=t&&(this._active=t,1==this._active?(this.init(),this.scane2d.dCont.add(this.dCont),this.content.visible=!0,this.sizeWindow(this._width,this._height)):(this.scane2d.dCont.remove(this.dCont),this.content.visible=!1))},get:function(){return this._active}},{key:\"sahMenu\",set:function(t){this._sahMenu!=t&&(this._sahMenu=t,this.dragSah())},get:function(){return this._sahMenu}}])&&g(i.prototype,e),s&&g(i,s),t}();function x(t){return(x=\"function\"==typeof Symbol&&\"symbol\"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&\"function\"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?\"symbol\":typeof t})(t)}function v(t){return(v=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function m(t,i){return(m=Object.setPrototypeOf||function(t,i){return t.__proto__=i,t})(t,i)}function _(t){if(void 0===t)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return t}function w(t,i){if(!(t instanceof i))throw new TypeError(\"Cannot call a class as a function\")}function b(t,i){for(var e=0;e<i.length;e++){var s=i[e];s.enumerable=s.enumerable||!1,s.configurable=!0,\"value\"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}function E(t,i,e){return i&&b(t.prototype,i),e&&b(t,e),t}var P=function(){function t(i,e){w(this,t),this.type=\"Stens\";var s=this;this.scane2d=i,this._active=!1,this.content=new PIXI.Container,this.content.visible=!1,i.content.addChild(this.content),this.dCont=new DCont,this._width=100,this._height=100,this._index=-1,this._sahMenu=0,this.bl=!1,this.array=[],this._wh=20,this.widthBig=i.glaf.widthBig,this.otstup=i.glaf.otstup,this.rectangle=new Rectangle(0,0,500,500),this.p=new PLPanel(this.content),this.p.alpha=.2,this.contS=new PIXI.Container,this.content.addChild(this.contS),this.rulit=new M(this,i.glaf.scane3d.room.content3d,function(t,i){e(t,i)}),this.plusSten=new R(this),this.sob=function(t,i){s.index=i.idArr,s.rulit.sob(t,i)},this.init=function(){1!=this.bl&&(this.bl=!0,this.array=i.glaf.scane3d.room.array,this.rulit.content.addChild(this.array[0].content),this.rulit.content.addChild(this.array[1].content),this.rulit.content.addChild(this.array[2].content),this.array[0].rotation=-Math.PI/2,this.array[0].x=0,this.array[0].y=this.array[0].width,this.array[0].sA1=2,this.array[0].active=!1,this.array[2].rotation=Math.PI/2,this.array[2].x=this.array[2].width,this.array[2].sA=2,this.array[2].active=!1,this.array[1].sA1=2,this.array[1].sA=2,this.array[1].x=0,this.array[1].y=0)},this.redrag=function(t){this.rulit.redrag(t)},this.sizeWindow=function(t,i){if(this._width=t,this._height=i,0!=this._active){if(0==this._sahMenu)this.rectangle.x=100,this.rectangle.width=t-200,this.rectangle.y=100,this.rectangle.height=i-250;else{var e=2*this.widthBig;this.rectangle.x=t-e-this.otstup-this.widthBig/2,this.rectangle.width=e,this.rectangle.y=i-e-this.otstup,this.rectangle.height=e}this.contS.x=this.rectangle.x,this.contS.y=this.rectangle.y,this.p.x=this.rectangle.x,this.p.y=this.rectangle.y,this.p.width=this.rectangle.width,this.p.height=this.rectangle.height,this.redrag()}}}return E(t,[{key:\"x\",set:function(t){this.content.x=t},get:function(){return this.content.x}},{key:\"y\",set:function(t){this.content.y=t},get:function(){return this.content.y}},{key:\"active\",set:function(t){this._active!=t&&(this._active=t,1==this._active?(this.init(),this.scane2d.dCont.add(this.dCont),this.content.visible=!0,this.sizeWindow(this._width,this._height)):(this.scane2d.dCont.remove(this.dCont),this.content.visible=!1))},get:function(){return this._active}},{key:\"index\",set:function(t){if(this._index!=t){this._index=t;for(var i=0;i<this.array.length;i++)i==this._index?this.array[i].actBig=!0:this.array[i].actBig=!1}},get:function(){return this._index}},{key:\"sahMenu\",set:function(t){this._sahMenu!=t&&(this._sahMenu=t,this.sizeWindow(this._width,this._height))},get:function(){return this._sahMenu}}]),t}(),R=function t(i){w(this,t),this.type=\"PlusSten\";var e=this;this.content=new PIXI.Container,i.contS.addChild(this.content),this.dCont=new DCont,i.dCont.add(this.dCont),this.wh=30,this.whOtstup=70,this._scale=1,this.abcd=[new B(this.content,\"A\",0,0),new B(this.content,\"B\",0,0),new B(this.content,\"C\",0,0),new B(this.content,\"D\",0,0)],this.aPosition=[new Position,new Position,new Position,new Position],this.onDownB=function(t,r){trace(this.yy,this.xx),\"start\"==t&&(i.array[0].savePozot(),i.array[2].savePozot(),s=i.rulit.content.toGlobal(n)),\"drag\"==t&&(0==this.idArr&&(i.array[0].width=i.array[0].pointOld.w+this.yy/e._scale,i.array[0].y=i.array[0].width,e.aButt[0].y=s.y+i.array[0].y*e._scale-i.array[0].depth*e._scale),2==this.idArr&&(i.array[2].width=i.array[2].pointOld.w+this.yy/e._scale,e.aButt[2].y=s.y+i.array[2].width*e._scale-i.array[2].depth*e._scale),e.redrahWH()),\"up\"==t&&i.rulit.redrag(500)},this.aButt=[new H(this.dCont,0,0,\" \",this.onDownB),null,new H(this.dCont,0,0,\" \",this.onDownB)],this.aButt[0].idArr=0,this.aButt[2].idArr=2,this.aButt[0].alpha=.5,this.aButt[2].alpha=.5,this.arrBoxLabel=[];var s=new PIXI.Point,n=new PIXI.Point(0,0);this.redrahWH=function(){this.aPosition[0].x=i.rulit.content.x+i.array[0].x*this._scale,this.aPosition[0].y=i.rulit.content.y+i.array[0].width*this._scale+i.array[1].y*this._scale,this.aPosition[1].x=i.rulit.content.x+i.array[1].x*this._scale,this.aPosition[1].y=i.rulit.content.y+i.array[1].y*this._scale,this.aPosition[2].x=i.rulit.content.x+i.array[1].x*this._scale+i.array[1].width*this._scale,this.aPosition[2].y=i.rulit.content.y+i.array[1].y*this._scale,this.aPosition[3].x=i.rulit.content.x+i.array[0].x*this._scale+i.array[1].width*this._scale,this.aPosition[3].y=i.rulit.content.y+i.array[2].width*this._scale+i.array[2].y*this._scale,0,1==i.array[0].active?(this.abcd[0].x=this.aPosition[0].x,this.abcd[0].y=this.aPosition[0].y,this.abcd[0].xx=-this.wh,this.abcd[0].yy=0,this.abcd[1].x=this.aPosition[1].x,this.abcd[1].y=this.aPosition[1].y,this.abcd[1].xx=-this.wh,this.abcd[1].yy=-this.wh,this.abcd[2].x=this.aPosition[2].x,this.abcd[2].y=this.aPosition[2].y,this.abcd[2].content.visible=!0,this.abcd[2].xx=this.wh,this.abcd[2].yy=-this.wh,i.array[2].active?(this.abcd[3].x=this.aPosition[3].x,this.abcd[3].y=this.aPosition[3].y,this.abcd[3].content.visible=!0,this.abcd[3].xx=this.wh,this.abcd[3].yy=0):this.abcd[3].content.visible=!1):(this.abcd[3].content.visible=!1,this.abcd[0].x=this.aPosition[1].x,this.abcd[0].y=this.aPosition[1].y,this.abcd[0].xx=-this.wh,this.abcd[0].yy=-this.wh,this.abcd[1].x=this.aPosition[2].x,this.abcd[1].y=this.aPosition[2].y,this.abcd[1].xx=this.wh,this.abcd[1].yy=-this.wh,i.array[2].active?(this.abcd[2].x=this.aPosition[3].x,this.abcd[2].y=this.aPosition[3].y,this.abcd[2].content.visible=!0,this.abcd[2].xx=this.wh,this.abcd[2].yy=0):this.abcd[2].content.visible=!1),s=i.rulit.content.toGlobal(n),this.arrBoxLabel[0].active=i.array[0].active,this.aButt[0].visible=i.array[0].active,1==i.array[0].active&&(this.arrBoxLabel[0].value=i.array[0].width,this.arrBoxLabel[0].x=s.x+i.array[1].x*this._scale-this.whOtstup,this.arrBoxLabel[0].y=s.y+i.array[1].y*this._scale+this.arrBoxLabel[0].value*this._scale/2,this.arrBoxLabel[0].actBig=i.array[0].actBig,this.aButt[0].x=s.x+i.array[0].x*this._scale-i.array[0].depth*this._scale,this.aButt[0].width=i.array[0].depth*this._scale,this.aButt[0].y=s.y+i.array[0].y*this._scale-i.array[0].depth*this._scale,this.aButt[0].height=i.array[0].depth*this._scale),this.arrBoxLabel[1].active=i.array[1].active,1==i.array[1].active&&(this.arrBoxLabel[1].value=i.array[1].width,this.arrBoxLabel[1].x=s.x+i.array[1].x*this._scale+this.arrBoxLabel[1].value*this._scale/2,this.arrBoxLabel[1].y=s.y+i.array[1].y*this._scale-1.5*this.wh,this.arrBoxLabel[1].actBig=i.array[1].actBig),this.arrBoxLabel[2].active=i.array[2].active,this.aButt[2].visible=i.array[2].active,1==i.array[2].active&&(this.arrBoxLabel[2].value=i.array[2].width,this.arrBoxLabel[2].x=s.x+i.array[2].x*this._scale+this.whOtstup,this.arrBoxLabel[2].y=s.y+i.array[2].y*this._scale+this.arrBoxLabel[2].value*this._scale/2,this.arrBoxLabel[2].actBig=i.array[2].actBig,this.aButt[2].x=s.x+i.array[2].x*this._scale,this.aButt[2].width=i.array[2].depth*this._scale,this.aButt[2].y=s.y+i.array[2].y*this._scale+i.array[2].width*this._scale-i.array[2].depth*this._scale,this.aButt[2].height=i.array[2].depth*this._scale)},this.redrahXY=function(t){this._scale=t,this.redrahWH()},this.chenge=function(){i.array[this.idArr].width=this.value+e.wh,i.rulit.redrag(500)};for(var r=0;r<3;r++)this.arrBoxLabel[r]=new S(this.dCont,this.chenge),this.arrBoxLabel[r].idArr=r},S=function(){function t(i,e){w(this,t);var s=this;this.fun=e,this.type=\"BoxLabel\",this._width=70,this._height=24,this._active=!1,this._actBig=!1,this.dC=i,this._value=100,this.dCont=new DCont,this.input=new DInput(this.dCont,-this._width/2,-this._height/2,this._value+\"\",function(){s.value=this.value/10,s.fun()}),this.input.width=this._width,this.input.height=this._height,this.input.visible=!1,this.lD=new DCont,this.dCont.add(this.lD),this.lD.div.style.textAlign=\"center\",this.lD.x=-(this._width+20)/2,this.lD.y=-this._height/2,this.label=new DLabel(this.lD,0,0,\"qw\"),this.label.width=this._width+20}return E(t,[{key:\"x\",set:function(t){this.dCont.x=t},get:function(){return this.dCont.x}},{key:\"y\",set:function(t){this.dCont.y=t},get:function(){return this.dCont.y}},{key:\"value\",set:function(t){this._value!=t&&(this._value=Math.round(t),this.input.text=\"\"+10*this._value,this.label.text=10*this._value+\" мм\")},get:function(){return this._value}},{key:\"active\",set:function(t){this._active!=t&&(this._active=t,1==this._active?this.dC.add(this.dCont):this.dC.remove(this.dCont))},get:function(){return this._active}},{key:\"actBig\",set:function(t){this._actBig!=t&&(this._actBig=t,this.input.visible=t,this.label.visible=!t)},get:function(){return this._actBig}}]),t}(),B=function(){function t(i,e,s,n){w(this,t),this._xx=s||0,this._yy=n||0,this.content=new PIXI.Container,i.addChild(this.content),this.label=new PLLabel(this.content,-5+this._xx,-10+this._yy,e)}return E(t,[{key:\"x\",set:function(t){this.content.x=t},get:function(){return this.content.x}},{key:\"y\",set:function(t){this.content.y=t},get:function(){return this.content.y}},{key:\"xx\",set:function(t){this._xx!=t&&(this._xx=t,this.label.x=-5+this._xx)},get:function(){return this._xx}},{key:\"yy\",set:function(t){this._yy!=t&&(this._yy=t,this.label.y=-10+this._yy)},get:function(){return this._yy}}]),t}(),M=function(){function t(i,e,s){w(this,t);var n,r,h,o=this;this.cont3d=e,this.tween=new TWEEN.Tween(this),this.content=new PIXI.Container,i.contS.addChild(this.content),this.fun=s,this.rectangle=new Rectangle(0,0,200,200),this.wh=20,this.p1=new PLPanel(this.content),this.p1.alpha=.2,this._scale=1,this.redrag=function(t){this.rectangle.height=i.array[0].width,this.rectangle.height<i.array[2].width&&(this.rectangle.height=i.array[2].width),this.rectangle.width=i.array[1].width,this.p1.width=this.rectangle.width,this.p1.height=this.rectangle.height,(n=i.rectangle.width/(this.rectangle.width+2*this.wh))>i.rectangle.height/(this.rectangle.height+2*this.wh)&&(n=i.rectangle.height/(this.rectangle.height+2*this.wh)),n>1&&(n=1),r=(i.rectangle.width-this.rectangle.width*n)/2,h=(i.rectangle.height-this.rectangle.height*n)/2,null==t?(this.x=r,this.y=h,this.scale=n):(this.tween.to({x:r,y:h,scale:n},500),this.tween.start())},this.sten,this.sobTip,this.sob=function(t,i){o.sten=void 0,\"onDown\"==t&&(this.sten=i,this.sobTip=t,this.onDragStart())},this.onDragStart=function(){c.x=9999999999;for(var t=0;t<i.array.length;t++)i.array[t].savePozot();pl102.isMouseEvents&&(pl102.stage.off(\"mouseup\",o.onDragEnd),pl102.stage.off(\"mousemove\",o.onDragMove),pl102.stage.on(\"mouseup\",o.onDragEnd),pl102.stage.on(\"mousemove\",o.onDragMove)),pl102.isTouchEvents&&(pl102.stage.off(\"touchend\",o.onDragEnd),pl102.stage.off(\"touchmove\",o.onDragMove),pl102.stage.on(\"touchend\",o.onDragEnd),pl102.stage.on(\"touchmove\",o.onDragMove)),this.onDragMove(),o.funDown&&o.funDown()};var a=!1,c=new PIXI.Point(9999999999,0);new PIXI.Point(0,0);this.onDragMove=function(t){9999999999==c.x&&(c.x=pl102.global.x,c.y=pl102.global.y,a=!1),calc.getDistance(c,pl102.global)>5&&(a=!0),1==a&&null!=o.sten&&(0==o.sten.idArr&&(o.sten.x=o.sten.pointOld.x-(c.x-pl102.global.x)/o._scale,i.array[1].x=o.sten.x,i.array[1].width=i.array[2].x-i.array[1].x),1==o.sten.idArr&&(o.sten.y=o.sten.pointOld.y-(c.y-pl102.global.y)/o._scale,i.array[0].width=i.array[0].pointOld.w+(c.y-pl102.global.y)/o._scale,i.array[0].y=o.sten.y+i.array[0].width,i.array[2].width=i.array[2].pointOld.w+(c.y-pl102.global.y)/o._scale,i.array[2].y=i.array[2].pointOld.y-(c.y-pl102.global.y)/o._scale),2==o.sten.idArr&&(o.sten.x=o.sten.pointOld.x-(c.x-pl102.global.x)/o._scale,i.array[1].width=i.array[2].x-i.array[1].x),o.redrahXY())},this.onDragEnd=function(t){if(\"onDown\"==o.sobTip){if(null!=o.sten){if(0==o.sten.idArr){var e=o.sten.x;o.x=(o.x+e)*o._scale;for(var s=0;s<i.array.length;s++)i.array[s].x-=e}if(1==o.sten.idArr){var n=o.sten.y;o.y=(o.y+n)*o._scale;for(s=0;s<i.array.length;s++)i.array[s].y-=n}o.redrag(500),o.redrahXY()}0==a&&(o.sten.active=!o.sten.active)}pl102.isMouseEvents&&(pl102.stage.off(\"mouseup\",o.onDragEnd),pl102.stage.off(\"mousemove\",o.onDragMove)),pl102.isTouchEvents&&(pl102.stage.off(\"touchend\",o.onDragEnd),pl102.stage.off(\"touchmove\",o.onDragMove))},this.redrahXY=function(){i.plusSten.redrahXY(this._scale)}}return E(t,[{key:\"x\",set:function(t){this.content.x=t,this.cont3d.position.x=-this.rectangle.width/2+t,this.redrahXY(),this.fun(\"visi3d\")},get:function(){return this.content.x}},{key:\"y\",set:function(t){this.content.y=t,this.cont3d.position.y=-this.rectangle.height/2+t,this.redrahXY(),this.fun(\"visi3d\")},get:function(){return this.content.y}},{key:\"width\",set:function(t){this._width!=t&&(this._width=t)},get:function(){return this._width}},{key:\"height\",set:function(t){this._height!=t&&(this._height=t)},get:function(){return this._height}},{key:\"scale\",set:function(t){this._scale!=t&&(this._scale=t,this.content.scale.set(this._scale,this._scale))},get:function(){return this._scale}}]),t}(),H=function(t){function i(t,e,s,n,r,h){var o;w(this,i),(o=function(t,i){return!i||\"object\"!==x(i)&&\"function\"!=typeof i?_(t):i}(this,v(i).call(this,t,e,s,n,r,h))).type=\"DBUtC\",null!=t&&null!=t.add&&t.add(_(_(o)));var a=_(_(o));o.fun=r,o._xx=0,o._yy=0;var c=void 0;return o.mouseup=function(t){c=void 0,0==dcmParam.mobile?(document.removeEventListener(\"mousemove\",a.mousemove),document.removeEventListener(\"mouseup\",a.mouseup)):(document.removeEventListener(\"touchend\",a.mouseup),document.removeEventListener(\"touchmove\",a.mousemove)),a.fun(\"up\")},o.mousemove=function(t){if(0==dcmParam.mobile){null==c&&(c={x:t.clientX,y:t.clientY,x1:a.xx,y1:a.yy},a.fun(\"start\"));var i=c.x1+(t.clientX-c.x);a.xx=i;i=c.y1+(t.clientY-c.y);a.yy=i,a.fun(\"drag\")}else{null==c&&(c={x:t.targetTouches[0].clientX,y:t.targetTouches[0].clientY,x1:a.x,y1:a.y});i=c.x1+(t.targetTouches[0].clientX-c.x);a.xx=i;i=c.y1+(t.targetTouches[0].clientY-c.y);a.yy=i,a.fun(\"drag\")}},o.fun_mousedown=function(){a.xx=0,a.yy=0,0==dcmParam.mobile?(document.addEventListener(\"mousemove\",a.mousemove),document.addEventListener(\"mouseup\",a.mouseup)):(document.addEventListener(\"touchend\",a.mouseup),document.addEventListener(\"touchmove\",a.mousemove))},o}return function(t,i){if(\"function\"!=typeof i&&null!==i)throw new TypeError(\"Super expression must either be null or a function\");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),i&&m(t,i)}(i,DButton),E(i,[{key:\"xx\",set:function(t){this._xx=t},get:function(){return this._xx}},{key:\"yy\",set:function(t){this._yy=t},get:function(){return this._yy}}]),i}();function T(t,i){for(var e=0;e<i.length;e++){var s=i[e];s.enumerable=s.enumerable||!1,s.configurable=!0,\"value\"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}var C=function(){function t(i,e){!function(t,i){if(!(t instanceof i))throw new TypeError(\"Cannot call a class as a function\")}(this,t),this.type=\"Scane2d\";var s=this;this.content=new PIXI.Container,i.content.addChild(this.content),this.glaf=i,this._width=100,this._height=100,this.dCont=new DCont(i.dCont),this._sahMenu=0,this.array=[],this.array[this.array.length]=this.munuStart=new y(this,function(){i.sahMenu=1}),this.munuStart.active=!0,this.array[this.array.length]=this.stens=new P(this,function(t,i){e(t,i)}),this.stens.active=!0,this.sizeWindow=function(t,i){s._width=t,s._height=i;for(var e=0;e<this.array.length;e++)this.array[e].sizeWindow(t,i)}}var i,e,s;return i=t,(e=[{key:\"sahMenu\",set:function(t){this._sahMenu!=t&&(this._sahMenu=t,this.munuStart.sahMenu=t,this.stens.sahMenu=t)},get:function(){return this._sahMenu}}])&&T(i.prototype,e),s&&T(i,s),t}();function D(){THREE.BufferGeometry.call(this),this.type=\"GeometrySten\",this._rect={x:0,y:0,width:100,height:100},this._arrBox=[],this._textureWidth=256,this._textureHeight=256,this._depth=256,this._z=0,this._prossentWidth=0,this._prossentHeight=0,this._isInside=!1,this._isInverse=!1,this._okrog=5;var t,i,e,s,n=[],r=[],h=[],o=[],a=0,c=0,l=[],u=[],d=[],f=0,p=[],g=new THREE.Vector3,y=new THREE.Vector3,x=new THREE.Vector3,v=new THREE.Vector3,m=new THREE.Vector2,_=new THREE.Vector2,w=new THREE.Vector2,b=new THREE.Vector2,E=0;this.setRect=function(t,i,e,s){this._rect.x=t,this._rect.y=i,this._rect.width=e,this._rect.height=s,this.update()},this.startArrRect=function(){E=0;for(var t=0;t<r.length;t++)r[t]=0;for(t=0;t<n.length;t++)n[t]=0;if(this._isInside)for(t=0;t<this._arrBox.length;t++)s=this._arrBox[t],this.fillPointFromBox(s.x,s.y,s.width,s.height);else this.fillPointExcludeBox()},this.fillPointExcludeBox=function(){a=0,c=0;for(var t=!1,i=0;i<this._arrBox.length;i++)s=this._arrBox[i],this._rect.x<s.x+s.width&&this._rect.y<s.y+s.height&&this._rect.x+this._rect.width>s.x&&this._rect.y+this._rect.height>s.y&&(this._rect.x<=s.x&&(l[a++]=s.x),this._rect.x+this._rect.width>=s.x+s.width&&(l[a++]=s.x+s.width),this._rect.y<=s.y&&(u[c++]=s.y),this._rect.y+this._rect.height>=s.y+s.height&&(u[c++]=s.y+s.height));0==a&&0==c&&(t=!0);for(i=this._rect.x+this._textureWidth;i<this._rect.x+this._rect.width;i+=this._textureWidth)l[a++]=i;for(i=this._rect.y+this._textureHeight;i<this._rect.y+this._rect.height;i+=this._textureHeight)u[c++]=i;l[a++]=this._rect.x,l[a++]=this._rect.x+this._rect.width,u[c++]=this._rect.y,u[c++]=this._rect.y+this._rect.height,u.length=c,l.length=a,u.sort(function(t,i){return t-i}),l.sort(function(t,i){return t-i});for(i=0;i<l.length;i++)l[i]==l[i+1]&&(l.splice(i+1,1),i--);for(i=0;i<u.length;i++)u[i]==u[i+1]&&(u.splice(i+1,1),i--);for(i=0;i<u.length;i++){null==p[i]&&(p[i]=[]);for(var e=0;e<l.length;e++)p[i][e]=this.inBox(l[e],u[i],l[e+1],u[i+1])}if(t)this.fillPointFromBox(l[0],u[0],Math.abs(l[l.length-1]-l[0]),Math.abs(u[u.length-1]-u[0]));else for(i=0;i<u.length-1;i++)for(e=0;e<l.length-1;e++)p[i][e]||this.fillPointOptimiz(e,i)},this.fillPointFromBox=function(t,i,e,s){if(this._rect){if(i+s<=this._rect.y)return;if(t+e<=this._rect.x)return;if(i>=this._rect.y+this._rect.height)return;if(t>=this._rect.x+this._rect.width)return}c=0,a=0;for(var n=this._rect.x+this._textureWidth;n<t+e;n+=this._textureWidth)n>=t&&n<=t+e&&(h[a++]=n);for(n=this._rect.y+this._textureHeight;n<i+s;n+=this._textureHeight)n>=i&&n<=i+s&&(o[c++]=n);t>=this._rect.x?h[a++]=t:h[a++]=this._rect.x,t+e<=this._rect.x+this._rect.width?h[a++]=t+e:h[a++]=this._rect.x+this._rect.width,i>=this._rect.y?o[c++]=i:o[c++]=this._rect.y,i+s<=this._rect.y+this._rect.height?o[c++]=i+s:o[c++]=this._rect.y+this._rect.height,o.length=c,h.length=a,o.sort(function(t,i){return t-i}),h.sort(function(t,i){return t-i});for(n=0;n<h.length;n++)(h[n]==h[n+1]||h[n+1]>this._rect.x+this._rect.width)&&(h.splice(n+1,1),n--);for(n=0;n<o.length;n++)(o[n]==o[n+1]||o[n+1]>this._rect.y+this._rect.height)&&(o.splice(n+1,1),n--);this.fillPointSetka()},this.pluspoli=function(t){this._isInverse&&(t=!t),t?(r[18*E+0]=g.x,r[18*E+1]=g.y,r[18*E+2]=g.z,r[18*E+3]=y.x,r[18*E+4]=y.y,r[18*E+5]=y.z,r[18*E+6]=x.x,r[18*E+7]=x.y,r[18*E+8]=x.z,r[18*E+9]=g.x,r[18*E+10]=g.y,r[18*E+11]=g.z,r[18*E+12]=x.x,r[18*E+13]=x.y,r[18*E+14]=x.z,r[18*E+15]=v.x,r[18*E+16]=v.y,r[18*E+17]=v.z,n[12*E+0]=m.x,n[12*E+1]=m.y,n[12*E+2]=_.x,n[12*E+3]=_.y,n[12*E+4]=w.x,n[12*E+5]=w.y,n[12*E+6]=m.x,n[12*E+7]=m.y,n[12*E+8]=w.x,n[12*E+9]=w.y,n[12*E+10]=b.x,n[12*E+11]=b.y):(r[18*E+0]=g.x,r[18*E+1]=g.y,r[18*E+2]=g.z,r[18*E+3]=x.x,r[18*E+4]=x.y,r[18*E+5]=x.z,r[18*E+6]=y.x,r[18*E+7]=y.y,r[18*E+8]=y.z,r[18*E+9]=g.x,r[18*E+10]=g.y,r[18*E+11]=g.z,r[18*E+12]=v.x,r[18*E+13]=v.y,r[18*E+14]=v.z,r[18*E+15]=x.x,r[18*E+16]=x.y,r[18*E+17]=x.z,n[12*E+0]=m.x,n[12*E+1]=m.y,n[12*E+2]=w.x,n[12*E+3]=w.y,n[12*E+4]=_.x,n[12*E+5]=_.y,n[12*E+6]=m.x,n[12*E+7]=m.y,n[12*E+8]=b.x,n[12*E+9]=b.y,n[12*E+10]=w.x,n[12*E+11]=w.y),E++},this.inBox=function(t,i,e,n){for(var r=0;r<this._arrBox.length;r++)if(t>=(s=this._arrBox[r]).x&&e<=s.x+s.width&&i>=s.y&&n<=s.y+s.height)return!0;return!1},this.fillPointOptimiz=function(t,i){findX=0;for(var e=i,s=0,n=0,r=0,h=t+1;e<u.length&&!(0==Math.abs((u[e]-this._rect.y)/this._textureHeight%1)&&e>i);h++)(p[e][h]||h==l.length-1||0==Math.abs((l[h]-this._rect.x)/this._textureWidth%1))&&(-1!=(n=this.getBoolRectPow(t,i,h,++e))&&(d[f++]=[h,e],s<n&&(s=n,r=f-1)),h=t);this.fillPointFromBox(l[t],u[i],Math.abs(l[d[r][0]]-l[t]),Math.abs(u[d[r][1]]-u[i])),this.setBoolRect(t,i,d[r][0],d[r][1])},this.setBoolRect=function(t,i,e,s){for(var n=i;n<p.length&&n<s;n++)for(var r=t;r<p[n].length&&r<e;r++)p[n][r]=!0},this.getBoolRectPow=function(t,i,e,s){for(var n=0,r=i;r<p.length&&r<s;r++)for(var h=t;h<p[r].length&&h<e;h++){if(p[r][h])return-1;n++}return n};var P=0,R=0,S=0,B=0,M=0,H=0,T=0,C=0;this.fillPointSetka=function(){for(var t=0;t<o.length-1;t++)for(var i=0;i<h.length-1;i++)0,P=h[i],S=o[t],R=h[i+1],B=o[t+1],M=Math.abs((P-this._rect.x)/this._textureWidth%1)||0,T=Math.abs((S-this._rect.y)/this._textureHeight%1)||0,H=Math.abs((R-this._rect.x)/this._textureWidth%1)||1,C=Math.abs((B-this._rect.y)/this._textureHeight%1)||1,g.set(P,S,this._z),y.set(R,S,this._z),x.set(R,B,this._z),v.set(P,B,this._z),m.set(M,T),_.set(H,T),w.set(H,C),b.set(M,C),this.pluspoli(),this._depth&&(g.set(P,S,this._z+this._depth),y.set(R,S,this._z+this._depth),x.set(R,B,this._z+this._depth),v.set(P,B,this._z+this._depth),m.set(M,T),_.set(H,T),w.set(H,C),b.set(M,C),this.pluspoli(!0),this.fillPointEdge(t,i))},this.fillPointEdge=function(t,i,e){P=h[i],S=o[t],R=h[i+1],B=o[t+1],M=Math.abs((P-this._rect.x)/this._textureWidth%1)||0,T=Math.abs((S-this._rect.y)/this._textureHeight%1)||0,H=Math.abs((R-this._rect.x)/this._textureWidth%1)||1,C=Math.abs((B-this._rect.y)/this._textureHeight%1)||1,0==t&&(g.set(P,S,this._z),y.set(R,S,this._z),x.set(R,S,this._z+this._depth),v.set(P,S,this._z+this._depth),m.set(M,0),_.set(H,0),w.set(H,1),b.set(M,1),this.pluspoli(!e)),t==o.length-2&&(g.set(P,B,this._z),y.set(R,B,this._z),x.set(R,B,this._z+this._depth),v.set(P,B,this._z+this._depth),m.set(M,0),_.set(H,0),w.set(H,1),b.set(M,1),this.pluspoli(e)),0==i&&(g.set(P,S,this._z),y.set(P,S,this._z+this._depth),x.set(P,B,this._z+this._depth),v.set(P,B,this._z),m.set(0,T),_.set(1,T),w.set(1,C),b.set(0,C),this.pluspoli(!e)),i==h.length-2&&(g.set(R,S,this._z),y.set(R,S,this._z+this._depth),x.set(R,B,this._z+this._depth),v.set(R,B,this._z),m.set(0,T),_.set(1,T),w.set(1,C),b.set(0,C),this.pluspoli(e))},this.createBuffer=function(){(!e||e.length<3*r.length)&&(e=new Float32Array(3*r.length),this.addAttribute(\"position\",new THREE.BufferAttribute(e,3)),i=new Float32Array(2*r.length),this.addAttribute(\"uv\",new THREE.BufferAttribute(i,2)),t=new Float32Array(3*r.length),this.addAttribute(\"normal\",new THREE.BufferAttribute(t,3)));for(var s=0;s<e.length;s++)e[s]=0;for(s=0;s<r.length;s++)this.attributes.position.array[s]=Math.round(100*r[s])/100;for(s=0;s<n.length;s++)i[s]=n[s];this.attributes.position.needsUpdate=!0,this.attributes.uv.needsUpdate=!0,this.computeVertexNormals(),this.attributes.normal.needsUpdate=!0,this.computeBoundingBox(),this.computeBoundingSphere()},this.update=function(){this.startArrRect(),this.createBuffer()},this.full=function(){this._textureHeight=this._rect.height,this._textureWidth=this._rect.width,this.update()},this.update(),Object.defineProperty(this,\"textureWidth\",{set:function(t){this._textureWidth!=t&&(this._textureWidth=t>0?t:1,this.update())},get:function(){return this._textureWidth}}),Object.defineProperty(this,\"textureHeight\",{set:function(t){this._textureHeight!=t&&(this._textureHeight=t>0?t:1,this.update())},get:function(){return this._textureHeight}}),Object.defineProperty(this,\"rect\",{set:function(t){this._rect=t,this.update()},get:function(){return this._rect}}),Object.defineProperty(this,\"arrBox\",{set:function(t){this._arrBox=t,this.update()},get:function(){return this._arrBox}}),Object.defineProperty(this,\"depth\",{set:function(t){this._depth!=t&&(this._depth=t,this.update())},get:function(){return this._depth}}),Object.defineProperty(this,\"isInside\",{set:function(t){this._isInside!=t&&(this._isInside=t,this.update())},get:function(){return this._isInside}}),Object.defineProperty(this,\"okrog\",{set:function(t){this._okrog!=t&&(this._okrog=t,this.update())},get:function(){return this._okrog}}),Object.defineProperty(this,\"prossentWidth\",{set:function(t){this._prossentWidth!=t&&(this._prossentWidth=t,this.update())},get:function(){return this._prossentWidth}}),Object.defineProperty(this,\"prossentHeight\",{set:function(t){this._prossentHeight!=t&&(this._prossentHeight=t,this.update())},get:function(){return this._prossentHeight}})}function O(){var t=new PIXI.Point(0,0),i=new PIXI.Point(0,0),e=new PIXI.Point(0,0),s=new PIXI.Point(0,0),n=new PIXI.Point(0,0),r=new PIXI.Point(0,0),h=new PIXI.Point(0,0),o=new PIXI.Point(0,0);this.stickBox=function(a,c,l){if(a){t.x=a.x,t.y=a.y,i.x=a.x+a.width,i.y=a.y,e.x=a.x+a.width,e.y=a.y+a.height,s.x=a.x,s.y=a.y+a.height;for(var u=0;u<c.length;u++)n.x=c[u].x,n.y=c[u].y,r.x=c[u].x+c[u].width,r.y=c[u].y,h.x=c[u].x+c[u].width,h.y=c[u].y+c[u].height,o.x=c[u].x,o.y=c[u].y+c[u].height,this.getDistance(t,o)<=l&&(a.x=c[u].x,a.y=c[u].y+c[u].height),this.getDistance(t,h)<=l&&(a.x=c[u].x+c[u].width,a.y=c[u].y+c[u].height),this.getDistance(t,r)<=l&&(a.x=c[u].x+c[u].width,a.y=c[u].y),this.getDistance(i,h)<=l&&(a.x=c[u].x+c[u].width-a.width,a.y=c[u].y+c[u].height),this.getDistance(i,o)<=l&&(a.x=c[u].x-a.width,a.y=c[u].y+c[u].height),this.getDistance(i,n)<=l&&(a.x=c[u].x-a.width,a.y=c[u].y),this.getDistance(e,r)<=l&&(a.x=c[u].x+c[u].width-a.width,a.y=c[u].y-a.height),this.getDistance(e,n)<=l&&(a.x=c[u].x-a.width,a.y=c[u].y-a.height),this.getDistance(e,o)<=l&&(a.x=c[u].x-a.width,a.y=c[u].y+c[u].height-a.height),this.getDistance(s,n)<=l&&(a.x=c[u].x,a.y=c[u].y-a.height),this.getDistance(s,r)<=l&&(a.x=c[u].x+c[u].width,a.y=c[u].y-a.height),this.getDistance(s,h)<=l&&(a.x=c[u].x+c[u].width,a.y=c[u].y+c[u].height-a.height)}},this.findMinPosition=function(t,i){for(var e,s=999,n={x:0,y:0},r=0;r<t.length;r++)s>(e=this.getDistance(t[r],i))&&(s=e,n.x=t[r].x,n.y=t[r].y);return n},this.getAngle=function(t,i){return 180*Math.atan2(i.y-t.y,i.x-t.x)/Math.PI},this.isPutIn=function(t,i,e,s,n,r,h,o){return t<=n&&t+e>=n+h&&e>=h&&i<=r&&i+s>=r+o&&s>=o},this.isCollisionRectangle=function(t,i,e,s,n,r,h,o){return t<n+h&&i<r+o&&t+e>n&&i+s>r},this.getDistance=function(t,i,e){return t&&i?Math.sqrt(Math.pow(t.x-i.x,2)+Math.pow(t.y-i.y,2)):0},this.getDistance3D=function(t,i,e){return Math.sqrt(Math.pow(t.x-i.x,2)+Math.pow(t.y-i.y,2)+Math.pow(t.z-i.z,2))}}function A(t,i,e){return i in t?Object.defineProperty(t,i,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[i]=e,t}function j(){var t=this;this.collUtil=new O,this.activBox={},this.arrBox=[],this.collisionBox=[],this._isCollisionAvtive=!1,this.dragBox,this.disStick=15,this.bigBox={x:0,y:0,width:100,height:100},this.tempBox={x:0,y:0,width:100,height:100},this.isStick=!1,this.hideBox=[],this.offsetHideBox=0,this.arrPointX=[],this.arrPointY=[],this.fun=null,this.funErr=null;var i=!0;this.correct=function(t){if(i=!0,this.checkArrPoint(),this.isStick&&this.stick(),this.bigBox&&this.checkBigBox(),this.moveBoxFromCollStop(),this.collisionBox=this.getCollisionBox(this.activBox,this.arrBox,this.activBox),0==this.collisionBox.length)return this._isCollisionAvtive=!1,this.isInBigBox(this.activBox)||(this.funErr&&this.funErr(this.activBox),i=!1),i;this._isCollisionAvtive=!0;var e=[];this.findPosition1(e),this.removePositFromHard(e),0==e.length&&this.findPosition2(e),0==e.length&&(this.funErr&&this.funErr(this.activBox),i=!1);var s=this.collUtil.findMinPosition(e,this.activBox);return t?(this.dragBox.x=s.x,this.dragBox.y=s.y):(this.activBox.x=s.x,this.activBox.y=s.y),i},this.getCollStop=function(t,i){if(this.activBox.coliziStop){if(t)return i?this.activBox.coliziStop.x:this.activBox.coliziStop.x+this.activBox.coliziStop.width;if(i)return this.activBox.coliziStop.y;var e=Math.max(this.activBox.coliziStop.height,this.activBox.height);return 0==this.activBox.coliziStop.height&&(e=0),this.activBox.coliziStop.y+e}return!1},this.moveBoxFromCollStop=function(){var t=this.getCollStop(!0,!0);if(!1!==t){var i=this.getCollStop(!0,!1),e=this.getCollStop(!1,!0),s=this.getCollStop(!1,!1);this.activBox.x+this.activBox.width>i&&(this.activBox.x=i-this.activBox.width),this.activBox.x<t&&(this.activBox.x=t),this.activBox.y+this.activBox.height>s&&(this.activBox.y=s-this.activBox.height),this.activBox.y<e&&(this.activBox.y=e)}},this.stick=function(){this.collUtil.stickBox(this.activBox,this.arrBox,this.disStick)},this.redactBox=function(t){this.activBox=t,this.arrBox.push(t);var i=this.correct();return this.arrBox.pop(),this.activBox=null,i},this.removePositFromHard=function(t){var i=this.getCollStop(!0,!0);if(!1!==i)for(var e=this.getCollStop(!0,!1),s=this.getCollStop(!1,!0),n=this.getCollStop(!1,!1),r=0;r<t.length;r++)t[r]&&t[r].y<s?t.splice(r--,1):t[r]&&t[r].y>n&&t.splice(r--,1),t[r]&&t[r].x<i?t.splice(r--,1):t[r]&&t[r].x>e&&t.splice(r--,1),Math.abs(Math.abs(n)-Math.abs(s))>0&&t[r]&&t[r].y+t[r].height>n&&t.splice(r--,1)},this.findPosition2=function(t){for(var i=[],e=0;e<this.collisionBox.length;e++){this.seeArrBox=[],this.findLevel=0,i=this.freePosition(this.activBox,this.collisionBox[e],this.arrBox);for(var s=0;s<i.length;s++)t.push(i[s])}},this.findPosition1=function(t){var i={};i.x=this.activBox.x,i.y=this.activBox.y,i.width=this.activBox.width,i.height=this.activBox.height,i.offset=0,this.activBox.offset&&(i.offset=this.activBox.offset);for(var e=0;e<this.collisionBox.length;e++){var s=this.getAngleBox(i,this.collisionBox[e]);this.moveBoxFromCollBox(i,this.collisionBox[e],s),this.isInBigBox(i,2)&&0==this.getCollisionBox(i,this.arrBox,this.activBox).length&&t.push(i)}},this.moveBoxFromCollBox=function(t,i,e){var s={},n={};n.x=i.x+i.width/2,n.y=i.y+i.height/2,s.x=i.x-(i.offset||0),s.y=i.y-(i.offset||0);var r=this.getAngle(n,s);s.x=i.x+i.width+(i.offset||0),s.y=i.y+i.height+(i.offset||0);var h=this.getAngle(n,s);s.x=i.x+i.width+(i.offset||0),s.y=i.y-(i.offset||0);var o=this.getAngle(n,s);s.x=i.x-(i.offset||0),s.y=i.y+i.height+(i.offset||0);var a=this.getAngle(n,s);e>=o&&e<h&&(t.x=i.x-t.width-(t.offset||0)-(i.offset||0)),e>=h&&e<a&&(t.y=i.y-t.height-(t.offset||0)-(i.offset||0)),e>=r&&e<o&&(t.y=i.y+i.height+(t.offset||0)+(i.offset||0)),(e>=a||e<r)&&(t.x=i.x+i.width+(t.offset||0)+(i.offset||0))},this.getAngleBox=function(t,i){var e={},s={};return e.x=t.x+t.width/2,e.y=t.y+t.height/2,s.x=i.x+i.width/2,s.y=i.y+i.height/2,this.getAngle(e,s)},this.maxLevel=1,this.findLevel=0,this.seeArrBox=[],this.freePosition=function(t,i,e){this.findLevel++,this.seeArrBox.push(i);for(var s=this.getPositionBox(t,i),n=[],r=[],h=[],o=0;o<s.length;o++)if(this.isInBigBox(s[o],2)){0==(h=this.getCollisionBox(s[o],e,t)).length&&n.push(s[o]);for(var a=0;a<h.length;a++)r.indexOf(h[a])<0&&r.push(h[a])}if(this.activBox.coliziStop&&this.removePositFromHard(n),0==n.length){if(this.findLevel>this.maxLevel)return n;for(o=0;o<r.length;o++)if(!this.equalsBox(this.seeArrBox,r[o])){var c=this.freePosition(t,r[o],e);for(a=0;a<c.length;a++)n.indexOf(c[a])<0&&n.push(c[a])}}return this.findLevel--,n},this.getPositionBox=function(t,i){return[this.getBox(i.x-t.width-(t.offset||0)-(i.offset||0),t.y,t.width,t.height,t.offset,t.offset,t.offset,t.offset),this.getBox(i.x+i.width+(t.offset||0)+(i.offset||0),t.y,t.width,t.height,t.offset,t.offset,t.offset,t.offset),this.getBox(t.x,i.y-t.height-(t.offset||0)-(i.offset||0),t.width,t.height,t.offset,t.offset,t.offset,t.offset),this.getBox(t.x,i.y+i.height+(t.offset||0)+(i.offset||0),t.width,t.height,t.offset,t.offset,t.offset,t.offset),this.getBox(i.x-t.width-(t.offset||0)-(i.offset||0),i.y-t.height-(t.offset||0)-(i.offset||0),t.width,t.height,t.offset,t.offset,t.offset,t.offset),this.getBox(i.x+i.width+(t.offset||0)+(i.offset||0),i.y-t.height-(t.offset||0)-(i.offset||0),t.width,t.height,t.offset,t.offset,t.offset,t.offset),this.getBox(i.x+i.width+(t.offset||0)+(i.offset||0),i.y+i.height+(t.offset||0)+(i.offset||0),t.width,t.height,t.offset,t.offset,t.offset,t.offset),this.getBox(i.x-t.width-(t.offset||0)-(i.offset||0),i.y+i.height+(t.offset||0)+(i.offset||0),t.width,t.height,t.offset,t.offset,t.offset,t.offset)]},this.getBox=function(t,i,e,s,n){var r;return A(r={x:t||0,y:i||0,width:e||0,height:s||0,offset:n||0},\"offset\",n||0),A(r,\"offset\",n||0),A(r,\"offset\",n||0),r},this.upData=function(){null!=this.activBox&&(this.collisionBox=this.getCollisionBox(this.activBox,this.arrBox,this.activBox),this.collisionBox.length>0?this._isCollisionAvtive=!0:this._isCollisionAvtive=!1)},this.updateWorld=function(){for(var t=0;t<this.arrBox.length;t++)this.activBox=this.arrBox[t],!this.correct()&&this.fun&&this.fun(t)},this.getCollisionBox=function(t,i,e){null==i&&(i=this.arrBox);var s,n=[];if(!t)return n;for(var r=0;r<i.length;r++)t!=(s=i[r])&&e!=s&&(this.offsetBox&&this.offsetBox==s||null!=s.visible&&0==s.visible||this.collUtil.isCollisionRectangle(t.x-(t.offset||0),t.y-(t.offset||0),t.width+(t.offset||0)+(t.offset||0),t.height+(t.offset||0)+(t.offset||0),s.x-(s.offset||0),s.y-(s.offset||0),s.width+(s.offset||0)+(s.offset||0),s.height+(s.offset||0)+(s.offset||0))&&n.push(s));for(r=0;r<this.hideBox.length;r++)t!=(s=this.hideBox[r])&&e!=s&&(this.offsetBox&&this.offsetBox==s||null!=s.visible&&0==s.visible||this.collUtil.isCollisionRectangle(t.x-(t.offset||0),t.y-(t.offset||0),t.width+(t.offset||0)+(t.offset||0),t.height+(t.offset||0)+(t.offset||0),s.x-(s.offset||0),s.y-(s.offset||0),s.width+(s.offset||0)+(s.offset||0),s.height+(s.offset||0)+(s.offset||0))&&n.push(s));return n},this.checkArrPoint=function(){},this.clearArrPoint=function(){this.arrPointX=[],this.arrPointY=[],this.hideBox=[]},this.checkBigBox=function(){for(var t=0;t<this.arrBox.length;t++)this.isInBigBox(this.arrBox[t])||(this.isCollisionBigBox(this.arrBox[t])?(this.arrBox[t].x-(this.arrBox[t].offset||0)<this.bigBox.x&&(this.arrBox[t].x=this.bigBox.x+(this.arrBox[t].offset||0)),this.arrBox[t].y-(this.arrBox[t].offset||0)<this.bigBox.y&&(this.arrBox[t].y=this.bigBox.y+(this.arrBox[t].offset||0)),this.arrBox[t].x+this.arrBox[t].width+(this.arrBox[t].offset||0)>this.bigBox.x+this.bigBox.width&&(this.arrBox[t].x=this.bigBox.x+this.bigBox.width-(this.arrBox[t].width+(this.arrBox[t].offset||0))),this.arrBox[t].y+this.arrBox[t].height+(this.arrBox[t].offset||0)>this.bigBox.y+this.bigBox.height&&(this.arrBox[t].y=this.bigBox.y+this.bigBox.height-(this.arrBox[t].height+(this.arrBox[t].offset||0)))):this.activBox&&(this.activBox,this.arrBox[t]))},this.isInBigBox=function(t,i){return!t||(!this.bigBox||this.collUtil.isPutIn(this.bigBox.x,this.bigBox.y,this.bigBox.width,this.bigBox.height,t.x-(t.offset||0)+(i||0),t.y-(t.offset||0)+(i||0),t.width+(t.offset||0)+(t.offset||0)-(i||0),t.height+(t.offset||0)+(t.offset||0)-(i||0)))},this.isCollisionBigBox=function(t){return!!t&&(!!this.bigBox&&this.collUtil.isCollisionRectangle(this.bigBox.x,this.bigBox.y,this.bigBox.width,this.bigBox.height,t.x-(t.offset||0),t.y-(t.offset||0),t.width+(t.offset||0)+(t.offset||0),t.height+(t.offset||0)+(t.offset||0)))},this.equalsBox=function(t,i){for(var e=0;e<t.length;e++)if(t[e].x==i.x&&t[e].y==i.y&&t[e].width==i.width&&t[e].height==i.height)return!0;return!1},this.getAngle=function(t,i){return 180*Math.atan2(i.y-t.y,i.x-t.x)/Math.PI},this.correctShahY=function(t){},this.offsetRect=0,this.checkRect=function(i,e,s){var n=!1,r=0,h=0,o={},a=t.getBox(i.x,i.y,i.width,i.height);switch(null==i.offset&&(n=!0,i.offset=this.offsetRect||0),e=parseInt(e)){case 0:var c=this.activBox;this.offsetBox=c,this.activBox=i,this.arrBox.push(i),this.correct(),this.arrBox.pop(),this.activBox=c,this.offsetBox=!1;break;case 1:o={x:i.x+i.width,y:i.y+i.height},!1!==(h=this.findAllBoxVect(o,e,i)).y&&i.y<=h.y&&(r=Math.abs(i.y-h.y),i.y=h.y,i.height-=Math.abs(r)),!1!==h.x&&i.x<=h.x&&(r=Math.abs(i.x-h.x),i.x=h.x,i.width-=Math.abs(r));break;case 2:o={x:i.x,y:i.y+i.height},!1===(h=this.findAllBoxVect(o,e,i)).y||isNaN(h.y)||i.y<=h.y&&(r=Math.abs(i.y-h.y),i.y=h.y,i.height-=Math.abs(r)),!1===h.x||isNaN(h.x)||i.x+i.width>=h.x&&(r=Math.abs(i.x+i.width-h.x),i.width-=Math.abs(r));break;case 3:o={x:i.x,y:i.y},!1===(h=this.findAllBoxVect(o,e,i)).y||isNaN(h.y)||i.y+i.height>=h.y&&(r=Math.abs(i.y+i.height-h.y),i.height-=Math.abs(r)),!1!==h.x&&i.x+i.width>=h.x&&(r=Math.abs(i.x+i.width-h.x),i.width-=Math.abs(r));break;case 4:o={x:i.x+i.width,y:i.y},!1===(h=this.findAllBoxVect(o,e,i)).y||isNaN(h.y)||i.y+i.height>=h.y&&(r=Math.abs(i.y+i.height-h.y),i.height-=Math.abs(r)),!1===h.x||isNaN(h.x)||i.x<=h.x&&(r=Math.abs(i.x-h.x),i.x=h.x,i.width-=Math.abs(r));break;default:console.warn(\"curs не определен\",e)}if(s){var l=(i.y+s)%s;i.y=i.y-l,e>0&&(i.height=i.height-(-l||(i.height+s)%s))}return n&&delete i.offset,parseInt(i.x)===parseInt(a.x)&&parseInt(i.width)===parseInt(a.width)},this.findAllBoxVect=function(i,e,s){for(var n=[],r=[],h=[],o=0;o<this.arrBox.length;o++)this.arrBox[o]!=this.activBox&&this.checkBoxCurs(i.x,i.y,this.arrBox[o],e)&&n.push(this.arrBox[o]);this.sortBoxXY(r,h,n,e,s),r.sort(function(i,s){return t.sortBoxCursor(i,s,e,!0)}),h.sort(function(i,s){return t.sortBoxCursor(i,s,e,!1)});var a={x:0,y:0};switch(e){case 1:if(r[0])a.x=r[0].x+r[0].width+(r[0].offset||0)+(s.offset||0);else a.x=t.bigBox.x+(s.offset||0),0!=(c=this.getCollStop(!0,!0))&&(a.x=c);return h[0]?a.y=h[0].y+h[0].height+(h[0].offset||0)+(s.offset||0):a.y=t.bigBox.y+(s.offset||0),a;case 2:if(r[0])a.x=r[0].x-(r[0].offset||0)-(s.offset||0);else a.x=t.bigBox.x+t.bigBox.width-(s.offset||0),0!=(c=this.getCollStop(!0,!1))&&(a.x=c);return h[0]?a.y=h[0].y+h[0].height+(h[0].offset||0)+(s.offset||0):a.y=t.bigBox.y+(s.offset||0),a;case 3:if(r[0])a.x=r[0].x-(r[0].offset||0)-(s.offset||0);else a.x=t.bigBox.x+t.bigBox.width-(s.offset||0),0!=(c=this.getCollStop(!0,!1))&&(a.x=c);return h[0]?a.y=h[0].y-(h[0].offset||0)-(s.offset||0):a.y=t.bigBox.y+t.bigBox.height-(s.offset||0),a;case 4:var c;if(r[0])a.x=r[0].x+r[0].width+(r[0].offset||0)+(s.offset||0);else a.x=t.bigBox.x+(s.offset||0),0!=(c=this.getCollStop(!0,!0))&&(a.x=c);return h[0]?a.y=h[0].y-(h[0].offset||0)-(s.offset||0):a.y=t.bigBox.y+t.bigBox.height-(s.offset||0),a}},this.sortBoxXY=function(t,i,e,s,n){for(var r=0,h=0,o=0;o<e.length;o++)1==s&&(n.x+n.width+(n.offset||0)<=e[o].x+e[o].width+(e[o].offset||0)?(r=1,h=0):n.y+n.height+(n.offset||0)<=e[o].y+e[o].height+(e[o].offset||0)?(r=0,h=1):(h=n.x-(n.offset||0)-(e[o].x+e[o].width+(e[o].offset||0)),r=n.y-(n.offset||0)-(e[o].y+e[o].height+(e[o].offset||0)))),2==s&&(n.x-(n.offset||0)>=e[o].x-(e[o].offset||0)?(r=1,h=0):n.y+n.height+(n.offset||0)<=e[o].y+e[o].height+(e[o].offset||0)?(r=0,h=1):(r=n.x+n.width+(n.offset||0)-(e[o].x-(e[o].offset||0)),h=e[o].y+e[o].height+(e[o].offset||0)-(n.y-(n.offset||0)))),3==s&&(n.x-(n.offset||0)>=e[o].x-(e[o].offset||0)?(r=1,h=0):n.y-(n.offset||0)>=e[o].y-(e[o].offset||0)?(r=0,h=1):(r=n.x+n.width+(n.offset||0)-e[o].x-(e[o].offset||0),h=n.y+n.height+(n.offset||0)-e[o].y-(e[o].offset||0))),4==s&&(n.x+n.width+(n.offset||0)<=e[o].x+e[o].width+(e[o].offset||0)?(r=1,h=0):n.y-(n.offset||0)>=e[o].y-(e[o].offset||0)?(r=0,h=1):(r=e[o].x+e[o].width+(e[o].offset||0)-(n.x-(n.offset||0)),h=n.y+n.height+(n.offset||0)-e[o].y-(e[o].offset||0))),r<h?t.push(e[o]):i.push(e[o])},this.sortBoxCursor=function(t,i,e,s){switch(e){case 1:return s?t.x+t.width+(t.offset||0)>i.x+i.width+(i.offset||0)?-1:t.x+t.width+(t.offset||0)<i.x+i.width+(i.offset||0)?1:0:t.y+t.height+(t.offset||0)>i.y+i.height+(i.offset||0)?-1:t.y+t.height+(t.offset||0)<i.y+i.height+(i.offset||0)?1:0;case 2:return s?t.x-(t.offset||0)<i.x-(i.offset||0)?-1:t.x-(t.offset||0)>i.x-(i.offset||0)?1:0:t.y+t.height+(t.offset||0)>i.y+i.height+(i.offset||0)?-1:t.y+t.height+(t.offset||0)<i.y+i.height+(i.offset||0)?1:0;case 3:return s?t.x-(t.offset||0)<i.x-(i.offset||0)?-1:t.x-(t.offset||0)>i.x-(i.offset||0)?1:0:t.y-(t.offset||0)<i.y-(i.offset||0)?-1:t.y-(t.offset||0)>i.y-(i.offset||0)?1:0;case 4:return s?t.x+t.width+(t.offset||0)>i.x+i.width+(i.offset||0)?-1:t.x+t.width+(t.offset||0)<i.x+i.width+(i.offset||0)?1:0:t.y-(t.offset||0)<i.y-(i.offset||0)?-1:t.y-(t.offset||0)>i.y-(i.offset||0)?1:0}},this.checkBoxCurs=function(t,i,e,s){switch(s){case 1:return!(e.x>=t)&&!(e.y>=i-1);case 2:return!(e.x+e.width<=t)&&!(e.y>=i);case 3:return!(e.x+e.width<=t)&&!(e.y+e.height<=i);case 4:return!(e.x>=t)&&!(e.y+e.height<=i)}}}D.prototype=Object.create(THREE.BufferGeometry.prototype),D.prototype.constructor=D,j.prototype={set isCollisionAvtive(t){this._isCollisionAvtive=t},get isCollisionAvtive(){return this.upData(),this._isCollisionAvtive}};var z,L=0;function I(t){var i=this,e=new PIXI.Container,s=new PLWindow(e,50,30*L,\"CollisionRect\"+(++L||\"\"));s.width=200,s.height=10,s.hasMinimizeButton=!0,s.minimize=!0;var n=new PIXI.Graphics;s.content.addChild(n),this.debug=!0,this.world=new W(0,0,400,300),null==z&&new V,this.colozi=new j,this.colozi.maxLevel=10,this.colozi.bigBox=this.world,this.colozi.funErr=function(t){};var r,h=[];this.arrRect=h,this.addRect=function(t,e){r=9999999;for(var s=0;s<h.length;s++)if(h[s].idRandom==t.idRandom){r=s;break}if(9999999==r){t.rectartID(),h.push(t),this.colozi.arrBox.push(t.rectCollisMeshdy),this.colozi.activBox=t.rectCollisMeshdy;var n=this.colozi.correct();return e||n||i.removeRect(t),l(),n}return l(),!0},this.removeRect=function(t,i){r=9999999;for(var e=0;e<h.length;e++)if(h[e].idRandom==t.idRandom){r=e;break}9999999!=r&&(this.colozi.arrBox.splice(r,1),r=h.splice(r,1),null==i&&this.removeRect(r,!0)),l()},this.addRectStatic=function(t){for(var i=0;i<this.colozi.hideBox.length;i++)if(this.colozi.hideBox[i]==t)return;this.colozi.hideBox.push(t),l()},this.removeRectStatic=function(t){for(var i=0;i<this.colozi.hideBox.length;i++)if(this.colozi.hideBox[i]==t)return this.colozi.hideBox.splice(i,1),void l()},this.clearNa=function(){if(0!=h.length)for(var t=0;t<h.length;t++)z.isState(this.world,h[t]),z.isState(h[t],this.world)},this.update=function(){this.colozi.updateWorld(),l()},this.testRect=function(t){this.colozi.redactBox(t.rectCollisMeshdy),l()},this.isCollisionBigBox=function(t){return this.colozi.isCollisionBigBox(t.rectCollisMeshdy)};var o=[],a=new PIXI.Container;function c(t,i){return i=i||100,parseInt(t*i)/i}function l(){if(n.clear(),n.visible&&i.debug)for(var t in n.position.set(-i.world.x,-i.world.y),o.forEach(function(t){t.destroy()}),o.length=0,n.lineStyle(1,0,.7),n.drawRect(i.colozi.bigBox.x,i.colozi.bigBox.y,i.colozi.bigBox.width,i.colozi.bigBox.height),n.lineStyle(1,65280,.7),i.colozi.arrBox){var e=i.colozi.arrBox[t];n.lineStyle(1,65280,.7),n.drawRect(e.x,e.y,e.width,e.height);var s=new PIXI.Text(t+\"->\\n\"+c(e.x)+\"-\"+c(e.y),{fontFamily:\"Arial\",fontSize:10,fill:16715792,textBaseline:\"Middle\"});s.position.set(e.x+e.width/2-20,e.y+e.height/2-5),a.addChild(s),o.push(s),e.coliziStop&&(n.lineStyle(1,15793935,.7),n.drawRect(e.coliziStop.x,e.coliziStop.y,e.coliziStop.width,e.coliziStop.height))}}n.addChild(a)}function k(t,i,e,s,n){this._x=t||0,this._y=i||0,this.width=e||100,this.height=s||100,this.fun=n}function W(t,i,e,s,n){var r=this;this.fun=n,this.x=t||0,this.y=i||0,this.sx=t||0,this.sy=i||0,this.width=e||100,this.height=s||100,this.position=new N(0,0,function(){r.rectCollisMeshdy.x=this.x+r.sx,r.rectCollisMeshdy.y=this.y+r.sy,r.rectCollisMeshdy.width=r.width,r.rectCollisMeshdy.height=r.height}),this.__x=t||0,this.__y=i||0,this.rectCollisMeshdy=new k(this.x,this.y,this.width,this.height,function(){r.__x=r.rectCollisMeshdy.x-r.sx,r.__y=r.rectCollisMeshdy.y-r.sy,r.fun&&r.fun()}),this.arrKri=[0,0,0,0],this.kolPoint=0,this.peresek=!1,this.idRandom=Math.random(),this.rectartID=function(){this.idRandom=Math.round(1e16*Math.random())/1e16},this.parent,this.set=function(t){this.x=t.x,this.y=-200,this.sx=t.x,this.sy=t.y,this.width=t.width,this.height=t.height,this.position.x=t.position.x,this.position.y=t.position.y,this.idRandom=t.idRandom};var h=new N;this.getPoint=function(t){return 0==t&&h.set(this.__x,this.y+this.position.y),1==t&&h.set(this.__x+this.width,this.y+this.position.y),2==t&&h.set(this.__x+this.width,this.y+this.position.y+this.height),3==t&&h.set(this.__x,this.y+this.position.y+this.height),4==t&&h.set(this.__x,this.y+this.position.y),h}}function N(t,i,e){this._x=t||0,this._y=i||0,this.fun=e,this.set=function(t,i){this.x=t,this.y=i}}function V(){var t,i;z=this,this.getAngle=function(t,i){return Math.atan2(i.y-t.y,i.x-t.x)},this.getDistance=function(t,i){return t&&i?Math.sqrt(Math.pow(t.x-i.x,2)+Math.pow(t.y-i.y,2)):0},this.getVector=function(t,i){var e=new THREE.Vector2(0,0);return e.x=Math.abs(t)*Math.cos(i),e.y=Math.abs(t)*Math.sin(i),e},this.isPutIn=function(t,i){return t.x+t.position.x<=i.x+i.position.x&&t.x+t.position.x+t.width>=i.x+i.position.x+i.width&&t.y+t.position.y<=i.x+i.position.y&&t.y+t.position.y+t.height>=i.y+i.position.y+i.height},this.isPointInRect=function(t,i){return t.x>i.x+i.position.x&&t.x<i.x+i.position.x+i.width&&t.y>i.y+i.position.y&&t.y<i.y+i.position.y+i.height?1:0},this.rectInRect=function(e,s){for(t=0,i=0;i<4;i++)1==s.arrKri[i]&&t++;return!(e.width<s.width)&&(!(e.height<s.height)&&((1==t||2==t)&&(1==t&&(1==s.arrKri[0]&&(s.position.x=e.x-e.position.x-s.x+e.width-s.width,s.position.y=e.y-e.position.y-s.y+e.height-s.height),1==s.arrKri[1]&&(s.position.x=e.x-e.position.x-s.x,s.position.y=e.y-e.position.y-s.y+e.height-s.height),1==s.arrKri[2]&&(s.position.x=e.x-e.position.x-s.x,s.position.y=e.y-e.position.y-s.y),1==s.arrKri[3]&&(s.position.x=e.x-e.position.x-s.x+e.width-s.width,s.position.y=e.y-e.position.y-s.y)),2==t&&(1==s.arrKri[0]&&1==s.arrKri[1]&&(s.position.y=e.y-e.position.y-s.y+e.height-s.height),1==s.arrKri[1]&&1==s.arrKri[2]&&(s.position.x=e.x-e.position.x-s.x),1==s.arrKri[2]&&1==s.arrKri[3]&&(s.position.y=e.y-e.position.y-s.y),1==s.arrKri[3]&&1==s.arrKri[0]&&(s.position.x=e.x-e.position.x-s.x+e.width-s.width)),!0)))};var e,s,n,r,h,o,a,c=new N,l=new N,u=new N,d=new N;this.isLineRect=function(t,i){var e,s;for(e=0;e<4;e++)for(c.x=t.getPoint(e).x,c.y=t.getPoint(e).y,l.x=t.getPoint(e+1).x,l.y=t.getPoint(e+1).y,s=0;s<4;s++)if(u.x=i.getPoint(s).x,u.y=i.getPoint(s).y,d.x=i.getPoint(s+1).x,d.y=i.getPoint(s+1).y,null!=this.getPointOfIntersection(c,l,u,d)&&0==this.testRadom(t,i))return!0;return!1},this.testRadom=function(t,i){return t.getPoint(0).x>i.getPoint(0).x&&this.numOkr(t.getPoint(0).x)==this.numOkr(i.getPoint(1).x)||(t.getPoint(1).y>i.getPoint(1).y&&this.numOkr(t.getPoint(0).y)==this.numOkr(i.getPoint(2).y)||(this.numOkr(t.getPoint(1).x)==this.numOkr(i.getPoint(0).x)||this.numOkr(t.getPoint(2).y)==this.numOkr(i.getPoint(0).y)))};var f=new N(0,0);this.getPointOfIntersection=function(t,i,c,l){return e=(t.x-i.x)*(l.y-c.y)-(t.y-i.y)*(l.x-c.x),s=(t.x-c.x)*(l.y-c.y)-(t.y-c.y)*(l.x-c.x),n=(t.x-i.x)*(t.y-c.y)-(t.y-i.y)*(t.x-c.x),h=n/e,(r=s/e)>=0&&r<=1&&h>=0&&h<=1?(o=t.x+r*(i.x-t.x),a=t.y+r*(i.y-t.y),f.x=o,f.y=a,f):null},this.isState=function(t,i){var e=0;i.kolPoint=0;for(var s=0;s<4;s++)i.arrKri[s]=this.isPointInRect(i.getPoint(s),t),1==i.arrKri[s]&&i.kolPoint++;return 0!=i.kolPoint&&(e=1),4==i.kolPoint&&(e=2),e},this.numOkr=function(t){return Math.round(1*t)/1}}function U(t,i){for(var e=0;e<i.length;e++){var s=i[e];s.enumerable=s.enumerable||!1,s.configurable=!0,\"value\"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}I.prototype={set width(t){this.world.width=t,this.clearNa()},get width(){return this.world.width}},k.prototype={set x(t){this._x=t,this.fun&&this.fun()},get x(){return this._x},set y(t){this._y=t,this.fun&&this.fun()},get y(){return this._y}},N.prototype={set x(t){this._x=t,this.fun&&this.fun()},get x(){return this._x},set y(t){this._y=t,this.fun&&this.fun()},get y(){return this._y}};var X=function(){function t(i,e){!function(t,i){if(!(t instanceof i))throw new TypeError(\"Cannot call a class as a function\")}(this,t),this.type=\"Sten\";var s,n=this;this.fun=e,this.idArr=-1,this.pointOld=new Position,this._width=200,this._height=20,this._color=16777215,this._colorBig=15658734,this._colorLine=14540253,this._active=!0,this._actBig=!1,this._sA=1,this._sA1=1,this.arrayPoint=[new Position,new Position,new Position,new Position],this._width=300,this._height=275,this._depth=20,this.contPoz3d=new THREE.Object3D,i.add(this.contPoz3d),this.content3d=new THREE.Object3D,this.contPoz3d.add(this.content3d),this.content3d.rotation.x=-Math.PI/2,this.collision=new I,this.collision.colozi.disStick=15,this.collision.colozi.isStick=!0,this.geometry=new D,this.geometry1=new D,this.geometry.depth=0,this.geometry1.depth=this._depth,this.material=new THREE.MeshPhongMaterial({color:16777215,transparent:!0,side:THREE.DoubleSide}),this.mesh=new THREE.Mesh(this.geometry,this.material),this.mesh.castShadow=!0,this.mesh.receiveShadow=!0,this.mesh1=new THREE.Mesh(this.geometry1,this.material),this.content3d.add(this.mesh),this.content3d.add(this.mesh1);for(var r=new THREE.BoxBufferGeometry(1,1,1),h=0;h<300;h++)(s=new THREE.Mesh(r,new THREE.MeshPhongMaterial({color:16777215*Math.random()}))).scale.set(2+2*Math.random(),2+2*Math.random(),2+2*Math.random()),s.rotation.set(6*Math.random(),6*Math.random(),6*Math.random()),this.content3d.add(s);this.drag=function(){for(var t=0;t<this.content3d.children.length;t++)this.content3d.children[t].position.set(Math.random()*this._width,Math.random()*this._height,0);this.geometry.setRect(0,0,this._width,this._height),this.mesh.position.set(0,0,0),this.geometry1.setRect(0,0,this._width,this._height),this.mesh1.position.set(0,0,-this._depth)},this.content=new PIXI.Container,this.graphics=new PIXI.Graphics,this.content.addChild(this.graphics),this.redrag=function(){this.graphics.clear(),0==this._actBig?this.graphics.beginFill(this._color):this.graphics.beginFill(this._colorBig),this.graphics.lineStyle(1,this._colorLine,1),this.redragPosit(),this.graphics.moveTo(this.arrayPoint[0].x,this.arrayPoint[0].y),this.graphics.lineTo(this.arrayPoint[1].x,this.arrayPoint[1].y),this.graphics.lineTo(this.arrayPoint[2].x,this.arrayPoint[2].y),this.graphics.lineTo(this.arrayPoint[3].x,this.arrayPoint[3].y),this.graphics.lineTo(this.arrayPoint[0].x,this.arrayPoint[0].y),this.graphics.lineStyle(2,16711680,1),this.graphics.moveTo(0,0),this.graphics.lineTo(this._width,0),this.drag(),n.fun(\"intRend\")},this.redragPosit=function(){this.arrayPoint[2].y=this.arrayPoint[3].y=-this._depth,this.arrayPoint[0].x=this.arrayPoint[3].x=0,this.arrayPoint[1].x=this.arrayPoint[2].x=this._width,0==this._sA&&(this.arrayPoint[0].x=-this._depth),2==this._sA&&(this.arrayPoint[3].x=-this._depth),0==this._sA1&&(this.arrayPoint[1].x=this._width+this._depth),2==this._sA1&&(this.arrayPoint[2].x=this._width+this._depth)},this.savePozot=function(){this.pointOld.x=this.x,this.pointOld.y=this.y,this.pointOld.w=this.width},this.mouseOut=function(t){},this.mouseOver=function(t){},this.onDown=function(t){e(\"onDown\",n)},this.graphics.interactive=!0,this.graphics.buttonMode=!0,pl102.isMouseEvents&&(this.graphics.on(\"mousedown\",this.onDown),this.graphics.on(\"mouseout\",this.mouseOut),this.graphics.on(\"mouseover\",this.mouseOver)),pl102.isTouchEvents&&this.graphics.on(\"touchstart\",this.onDown)}var i,e,s;return i=t,(e=[{key:\"rotation\",set:function(t){this._rotation!=t&&(this._rotation=t,this.content.rotation=t,this.contPoz3d.rotation.z=t)},get:function(){return this._rotation}},{key:\"x\",set:function(t){this.contPoz3d.position.x=t,this.content.x=t},get:function(){return this.content.x}},{key:\"y\",set:function(t){this.contPoz3d.position.y=t,this.content.y=t},get:function(){return this.content.y}},{key:\"width\",set:function(t){this._width!=t&&(this._width=t,this.redrag())},get:function(){return this._width}},{key:\"height\",set:function(t){this._height!=t&&(this._height=t,this.redrag())},get:function(){return this._height}},{key:\"depth\",set:function(t){this._depth!=t&&(this._depth=t,this.geometry1.depth=this._depth,this.redrag())},get:function(){return this._depth}},{key:\"active\",set:function(t){this._active!=t&&(this._active=t,1==this._active?(this.contPoz3d.visible=!0,this.graphics.alpha=1):(this.contPoz3d.visible=!1,this.graphics.alpha=.5))},get:function(){return this._active}},{key:\"actBig\",set:function(t){this._actBig!=t&&(this._actBig=t,this.redrag())},get:function(){return this._actBig}},{key:\"sA\",set:function(t){this._sA!=t&&(this._sA=t,this.redrag())},get:function(){return this._sA}},{key:\"sA1\",set:function(t){this._sA1!=t&&(this._sA1=t,this.redrag())},get:function(){return this._sA1}}])&&U(i.prototype,e),s&&U(i,s),t}();function G(t,i){if(!(t instanceof i))throw new TypeError(\"Cannot call a class as a function\")}function F(t,i){for(var e=0;e<i.length;e++){var s=i[e];s.enumerable=s.enumerable||!1,s.configurable=!0,\"value\"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}var Z=function(){function t(i,e){G(this,t),this.type=\"Room\";this._sahMenu=0,this.par=i,this._height=275,this._depth=20,this.content3d=new THREE.Object3D,this.par.content3d.add(this.content3d),this.content3d.position.z=this._height/2,this.sob=function(t,i){e(t,i)},this.array=[];for(var s=0;s<3;s++)this.array[s]=new X(this.content3d,this.sob),this.array[s].idArr=s;this.menedsher=new Y(this,function(t,i){e(t,i)}),this.pObject=new DParamObject(i.par.dCont,802,100),this.pObject.addObject(this)}var i,e,s;return i=t,(e=[{key:\"height\",set:function(t){if(this._height!=t){this._height=t,this.content3d.position.z=this._height/2;for(var i=0;i<this.array.length;i++)this.array[i].height=t}},get:function(){return this._height}},{key:\"depth\",set:function(t){if(this._depth!=t){this._depth=t;for(var i=0;i<this.array.length;i++)this.array[i].depth=t}},get:function(){return this._depth}}])&&F(i.prototype,e),s&&F(i,s),t}(),Y=function t(i,e){G(this,t),this.type=\"Menedsher\";this.par=i,this.content3d=new THREE.Object3D,i.content3d.add(this.content3d),this.menedsherObject=new q(this)},q=function t(i,e){G(this,t),this.type=\"MenedsherObject\";this.par=i,this.visi3D=i.par.par.par.visi3D,trace(\"this.visi3D  \",this.visi3D)};function K(t,i){for(var e=0;e<i.length;e++){var s=i[e];s.enumerable=s.enumerable||!1,s.configurable=!0,\"value\"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}var J=function(){function t(i,e){!function(t,i){if(!(t instanceof i))throw new TypeError(\"Cannot call a class as a function\")}(this,t),this.type=\"Scane3d\";this.par=i,this._sahMenu=0,this.visi3D=i.visi3D,this.content3d=new THREE.Object3D,this.content3d.visible=!1,i.content3d.add(this.content3d),this.room=new Z(this,function(t,i){e(t,i)}),this.sizeWindow=function(t,i){}}var i,e,s;return i=t,(e=[{key:\"sahMenu\",set:function(t){this._sahMenu!=t&&(this._sahMenu=t,0==this._sahMenu&&(this.content3d.visible=!1),1==this._sahMenu&&(this.content3d.visible=!0),this.visi3D.intRend=1)},get:function(){return this._sahMenu}}])&&K(i.prototype,e),s&&K(i,s),t}();function Q(t,i){for(var e=0;e<i.length;e++){var s=i[e];s.enumerable=s.enumerable||!1,s.configurable=!0,\"value\"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}var tt=function(){function t(i){!function(t,i){if(!(t instanceof i))throw new TypeError(\"Cannot call a class as a function\")}(this,t),this.type=\"Glaf\";var e=this;this.content3d=new THREE.Object3D,this.content=new PIXI.Container,this.dCont=void 0,this.main=i,this.otstup=2,this.widthBig=128+3*this.otstup,this._sahMenu=0,new Calc,this.visi3D=new s.a(i.contentHTML,i.content2d,!1,!0,!0,!0,!1),this.visi3D.yes3d=!0,this.visi3D.groupObject.add(this.content3d),i.contentHTML.appendChild(i.renderer.view),i.content2d.addChild(this.content),this.dCont=new DCont(i.contentHTML),this.scane3d=new J(this,function(t,i){\"visi3d\"!=t&&\"intRend\"!=t?\"onDown\"==t&&e.scane2d.stens.sob(t,i):e.visi3D.intRend=1}),this.scane2d=new C(this,function(t,i){\"visi3d\"!=t&&\"intRend\"!=t||(e.visi3D.intRend=1)}),this.menuDiv=new r(this),this.galleres=new d(this),this.update=function(){this.visi3D.upDate()},this.sizeWindow=function(t,i){this.menuDiv.sizeWindow(t,i),this.scane2d.sizeWindow(t,i),this.scane3d.sizeWindow(t,i),this.galleres.sizeWindow(t,i),this.visi3D.sizeWindow(0,0,t,i)},this.sahMenu=1}var i,e,n;return i=t,(e=[{key:\"sahMenu\",set:function(t){this._sahMenu!=t&&(this._sahMenu=t,this.menuDiv.sahMenu=t,this.scane2d.sahMenu=t,this.scane3d.sahMenu=t,this.galleres.sahMenu=t)},get:function(){return this._sahMenu}}])&&Q(i.prototype,e),n&&Q(i,n),t}();e(10);e.d(i,\"a\",function(){return it});var it=function t(i){!function(t,i){if(!(t instanceof i))throw new TypeError(\"Cannot call a class as a function\")}(this,t),this.type=\"LMain\";var e=this;this.stage=null,this.content2d=null,this.renderer=null,this.glaf=null,this._width=100,this._height=100,e.resolution=1,e.objectBase=null,this.localStorage,this.contentHTML=document.createElement(\"div\"),this.contentHTML.style.position=\"fixed\",this.contentHTML.style.top=\"0px\",this.contentHTML.style.left=\"0px\",document.body.appendChild(this.contentHTML),this.start=function(){this.start1()},this.start1=function(){this.stage=new PIXI.Container,this.renderer=new PIXI.autoDetectRenderer(this._width,this._height,{antialias:!0,transparent:!0,preserveDrawingBuffer:!0}),this.renderer.view.style.position=\"fixed\",this.content2d=new PIXI.Container,e.stage.addChild(this.content2d);var t=new PIXI.ticker.Ticker;t.minFPS=50,t.add(this.tick,this),t.start(),e.init2()},this.fina=function(){trace(e.localStorage),e.init2();var t=0;document.addEventListener(\"keydown\",function i(s){\"q\"!=s.key&&\"й\"!=s.key||(t++,trace(t),10==t&&(e.localStorage.object.activ=!e.localStorage.object.activ,e.sizeWindow(200,200),e.localStorage.save(),e.finalComplete(),document.removeEventListener(\"keydown\",i)))}),trace(\"MMM111MMMM\")},trace(\"MMMMMMMMMMMM444444444MMMMM\"),this.init2=function(){new StylePL102(this.stage,this.renderer,this.contentHTML),trace(e.localStorage),e.glaf=new tt(this),i(\"init\")},this.tick=function(){e.renderer.resolution=window.devicePixelRatio*e.resolution,e.renderer.render(e.stage),TWEEN.update(),e.glaf&&e.glaf.update()},this.sizeWindow=function(t,i){if(e._width=t,e._height=i,e.renderer){var s=e.resolution;e.renderer.view.style.width=e._width+\"px\",e.renderer.view.style.height=e._height+\"px\",e.renderer.resolution=1,e.renderer.resize(e._width,e._height),e.renderer.resolution=s}e.glaf&&e.glaf.sizeWindow(t,i)},$.ajax({url:\"resources/config.json\",success:function(t){if(\"string\"==typeof t){var i=JSON.parse(t);e.objectBase=i}else e.objectBase=t;e.start()},error:function(t){trace(\"Что то случилось с конфигом\")}})}},function(t,i,e){\"use strict\";function s(){var t=this,i=256,e=256,s=new THREE.Scene,n=new THREE.OrthographicCamera(i/-2,i/2,e/2,e/-2,.001,1e4),r=(new THREE.Clock,new THREE.WebGLRenderer({antialias:!0,alpha:!0,preserveDrawingBuffer:!0}));n.position.set(200,200,200),s.add(n),this.camera=n,this.fotoContainer=new THREE.Object3D,s.add(this.fotoContainer),s.background=new THREE.Color(38655),r.setPixelRatio(window.devicePixelRatio),r.setSize(i,e),r.localClippingEnabled=!0;var h=document.createElement(\"div\");h.style.position=\"absolute\",h.style.bottom=\"0px\",h.style.left=\"0px\",h.appendChild(r.domElement),this.contentHTML=h,this.canvas=r.domElement,this.contentHTML=h;var o=new THREE.AmbientLight(\"#ffffff\",1);s.add(o);var a=new THREE.GridHelper(1e3,10),c=new THREE.AxesHelper(100),l=new THREE.BoxHelper(this.fotoContainer,16776960);s.add(a),s.add(c),s.add(l);var u=[c,a,l];function d(){f(),l.setFromObject(t.fotoContainer)}function f(){r.render(s,n)}this.render=f,d();var p=new THREE.Box3,g=new THREE.Vector3;this.box=p,this.center=g,this.setSize=function(t,s){i=t,e=s,r.setSize(i,e),n.aspect=i/e,n.updateProjectionMatrix()},this.addObjFoto=function(t){this.fotoContainer.add(t),l.setFromObject(this.fotoContainer)},this.removeObjFoto=function(t){this.fotoContainer.remove(t)},this.moveToObj=function(i){p.setFromObject(i||t.fotoContainer);var e=p.max.x-p.min.x,s=p.max.z-p.min.z;t.moveToRect(p.min.x,p.min.z,e,s)},this.moveToRect=function(t,i,e,s){if(t+=e/2,i+=s/2,g.set(t,0,i),n.position.set(g.x,9e3,g.z),n.lookAt(g),y.target.set(g.x,g.y,g.z),\"OrthographicCamera\"===n.type){var r=Math.max(s,e);n.zoom=1,n.left=r/-2,n.right=r/2,n.top=r/2,n.bottom=r/-2,n.aspect=r/r}n.updateProjectionMatrix()},this.getFoto=function(t){t=t||1024;for(var n=0;n<u.length;n++)u[n].visible=!1;var h=s.background;s.background=null,r.setSize(t,t),f();var o=r.domElement.toDataURL(\"image/png\");r.setSize(i,e),s.background=h;for(var a=0;a<u.length;a++)u[a].visible=!0;return f(),o},this.getCanvas=function(t){t=t||1024;for(var i=0;i<u.length;i++)u[i].visible=!1;s.background;s.background=null;var e=r.getSize();return e.width==t&&e.height==t||r.setSize(t,t),f(),r.domElement};var y=new THREE.OrbitControls(n,h);y.enableKeys=!1,y.minDistance=1,y.minZoom=1,y.maxZoom=1,y.addEventListener(\"change\",function(){d()})}function n(t){var i=this,e=THREE.Math.generateUUID(),n=new THREE.Vector3(0,1,0),a=(new THREE.Plane(n,.01),new THREE.Vector4(0,999,0,.001)),c=new THREE.Box3,l=t||new s;this.foto3D=l;var u=new THREE.Vector2(0,0),d=100,f=new h;this.canvas=f.canvas,this.isTime=!1;var p=new THREE.Texture(f.canvas);this.texturePlan=p,this.matPlan=new THREE.MeshPhongMaterial({transparent:!0,side:THREE.DoubleSide,map:p});var g=new o;this.canvasGG=g,g.arrColorStopTranspanent[0]=.15,g.arrProcent[0]=.82,g.arrColorStopTranspanent[1]=1,g.arrProcent[1]=1,g.update();var y=new THREE.Texture(g.canvas);y.needsUpdate=!0,this.textureShadow=y,this.content3d=new THREE.Object3D,this.shadowContent3d=new THREE.Object3D,this.meshPlan=new THREE.Mesh(new THREE.PlaneBufferGeometry(1,1),this.matPlan),this.meshPlan.rotation.x=-Math.PI/2,this.content3d.add(this.meshPlan);var x=new THREE.Mesh(new THREE.SphereBufferGeometry(10,16,16));x.position.set(a.x,a.y,a.z),this.arrShadowMesh=[],this.arrObj=[],this._dunamic=!0,this.dirty=!0,this._lightPosition4D=a,this._fotoPosition=new THREE.Vector2(0,0),this._fotoWH=150,this._imgWH=512,this._imgBlur=1,this._imgAlpha=1,this._offsetY=0,this._scaleShadow=1,this._isDinamFotoRect=!1,this._opacityMat=1;var v=[new THREE.Plane(new THREE.Vector3(0,-1,0),100),new THREE.Plane(new THREE.Vector3(0,1,0),0)];this._shadowMaterial=new THREE.MeshBasicMaterial({side:THREE.DoubleSide,transparent:!0,opacity:this._opacityMat,depthWrite:!1,map:y,clippingPlanes:v,clipIntersection:!1}),this.arrDataSempl=[],this.arrDataSempl.push(new r(0,200,3,1));var m=new THREE.Group;this.content3d.add(m);var _=new THREE.Mesh(new THREE.PlaneBufferGeometry(1,1),new THREE.MeshBasicMaterial({side:THREE.DoubleSide,map:y,transparent:!0}));_.scale.set(1,30,1),_.rotation.z=-Math.PI/2,m.add(_),m.visible=!1,this.helpers=m,this.setConstMax=function(t){v[0].constant=t},this.setConstMin=function(t){v[1].constant=-t},this.addObj=function(t){if(-1==i.arrObj.indexOf(t)){t.updateMatrixWorld();var e=t.clone();!function t(i,e){i.userData.targetObject=e;for(var s=0;s<i.children.length;s++){if(!e.children[s])throw new Error(\"обекты не одинаковы\");t(i.children[s],e.children[s])}}(e,t),function(t){var e=[];!function t(i,e){\"Mesh\"==i.type&&e.push(i);for(var s=0;s<i.children.length;s++)\"Mesh\"==i.type?e.push(i.children[s]):t(i.children[s],e)}(t,e);for(var s=0;s<e.length;s++)e[s].material=i._shadowMaterial}(e),i.arrShadowMesh.push(e),i.arrObj.push(t),i.shadowContent3d.add(e),this.dirty=!0}},this.removeObj=function(t){var e=i.arrObj.indexOf(t);-1!=e&&(i.arrObj.splice(e,1),i.shadowContent3d.remove(i.arrShadowMesh[e]),i.arrShadowMesh.splice(e,1),this.dirty=!0)},this.clear=function(){for(var t=0;(t=i.arrObj.length)>0;)if(i.removeObj(i.arrObj[t-1]),t===i.arrObj.length)throw new Error(\"object not remove\")},this.intRend=1,this.intRendOk=1,this.upDate=function(){i.opacityMat&&(i.dunamic&&(i.intRend=i.intRendOk),i.intRend==i.intRendOk&&(i.dirty||function(){for(var t=0;t<i.arrShadowMesh.length;t++)if((i._isDinamFotoRect||w(i.arrShadowMesh[t]))&&b(i.arrShadowMesh[t]))return!0;return!1}())&&i.render(),i.intRend++)};function w(t){var e=!1,s=!1,n=c.min.x,r=c.min.z,h=c.max.x-c.min.x,o=c.max.z-c.min.z;if(c.setFromObject(t.userData.targetObject),e=H(n=c.min.x,r=c.min.z,h=c.max.x-c.min.x,o=c.max.z-c.min.z,i.fotoPosition.x,i.fotoPosition.y,i.fotoWH,i.fotoWH),c.setFromObject(t),s=H(n=c.min.x,r=c.min.z,h=c.max.x-c.min.x,o=c.max.z-c.min.z,i.fotoPosition.x,i.fotoPosition.y,i.fotoWH,i.fotoWH),!e&&!s)return!1;e=!1,s=!1;for(var a=0;a<t.children.length;a++)if(c.setFromObject(t.children[a].userData.targetObject),n=c.min.x,r=c.min.z,h=c.max.x-c.min.x,o=c.max.z-c.min.z,e=e||H(n,r,h,o,i.fotoPosition.x,i.fotoPosition.y,i.fotoWH,i.fotoWH),c.setFromObject(t.children[a]),n=c.min.x,r=c.min.z,h=c.max.x-c.min.x,o=c.max.z-c.min.z,s=s||H(n,r,h,o,i.fotoPosition.x,i.fotoPosition.y,i.fotoWH,i.fotoWH),e||s)return!0;return!0}function b(t){if(!function(t,i){if(t.position.equals(i.position)&&t.quaternion.equals(i.quaternion)&&t.scale.equals(i.scale)&&t.visible===i.visible)return!0;return!1}(t,t.userData.targetObject))return!0;for(var i=0;i<t.children.length;i++)if(b(t.children[i]))return!0;return!1}function E(t){!function(t,i){t.position.copy(i.position),t.quaternion.copy(i.quaternion),t.scale.copy(i.scale),t.visible=i.visible}(t,t.userData.targetObject);for(var i=0;i<t.children.length;i++)E(t.children[i])}this.render=function(){i.isTime&&console.time(\"render \"+e),i.dirty=!1,function(){a.w=.001,x.position.set(a.x,a.y,a.z);for(var t=0;t<i.arrShadowMesh.length;t++)E(i.arrShadowMesh[t]);B()}(),l.addObjFoto(i.shadowContent3d),d=i.fotoWH,u.x=i.fotoPosition.x,u.y=i.fotoPosition.y,i.isDinamFotoRect&&(c.setFromObject(i.shadowContent3d),u.x=c.min.x,u.y=c.min.z,d=Math.max(c.max.x-c.min.x,c.max.z-c.min.z),u.x-=100,u.y-=100,d+=200),l.moveToRect(u.x,u.y,d,d),function(){var t=l.getCanvas(i.imgWH);f.setCanvas(t),0==i.arrDataSempl.length&&f.update();for(var e=0;e<i.arrDataSempl.length;e++)i.setConstMin(i.arrDataSempl[e].min*i._scaleShadow+i._offsetY),i.setConstMax(i.arrDataSempl[e].max*i._scaleShadow+i._offsetY),l.render(),f._blur=i.arrDataSempl[e].blur+(i._scaleShadow>1?i._scaleShadow:0),f._alpha=i.arrDataSempl[e].alpha,f.update();i.setConstMin(-999999),i.setConstMax(999999),p.needsUpdate=!0}(),i.meshPlan.scale.set(d,d,1),i.meshPlan.position.set(u.x+d/2,0,u.y+d/2),i.isTime&&console.timeEnd(\"render \"+e),i.onUpdate&&i.onUpdate()};var P=new THREE.Box3(new THREE.Vector3,new THREE.Vector3(300,300,300));this.boundingBoxUv=P;var R=new THREE.Vector3;function S(t){if(\"Mesh\"===t.type){var e=!1,s=t.getWorldPosition(t.position),n=t.getWorldQuaternion(t.quaternion),r=i.maxHeight;s.y-=i._offsetY,t.userData.pos?t.userData.pos.y!=s.y?e=!0:t.userData.rot.equals(n)?t.userData.maxHeight!==r?e=!0:t.userData.scaleShadow!==i._scaleShadow&&(e=!0):e=!0:e=!0,i._isDinamFotoRect||(c.setFromObject(t),H(c.min.x,c.min.z,c.max.x-c.min.x,c.max.z-c.min.z,i.fotoPosition.x,i.fotoPosition.y,i.fotoWH,i.fotoWH)||(e=!1)),e&&(!function(t){t.geometry.uuid===t.userData.targetObject.geometry.uuid&&(t.geometry=t.userData.targetObject.geometry.clone());var e=P,s=0;if(t.geometry instanceof THREE.Geometry){for(var n=t.geometry.faces,r=t.geometry.vertices,h=t.geometry.faceVertexUvs[0],o=0;o<n.length;o++)R.set(r[n[o].a].x,r[n[o].a].y,r[n[o].a].z),t.localToWorld(R),s=1-T(R.y-i._offsetY,e.min.y,e.min.y+e.max.y)/100,h[o][0].set(s,s),R.set(r[n[o].b].x,r[n[o].b].y,r[n[o].b].z),t.localToWorld(R),s=1-T(R.y-i._offsetY,e.min.y,e.min.y+e.max.y)/100,h[o][1].set(s,s),R.set(r[n[o].c].x,r[n[o].c].y,r[n[o].c].z),t.localToWorld(R),s=1-T(R.y-i._offsetY,e.min.y,e.min.y+e.max.y)/100,h[o][2].set(s,s);t.geometry.uvsNeedUpdate=!0}else{var a=t.geometry.attributes.position.array;t.geometry.attributes.uv||(arrUvAttribut=new Float32Array(a.length/3*2),t.geometry.addAttribute(\"uv\",new THREE.BufferAttribute(arrUvAttribut,2)));var c=t.geometry.attributes.uv.array,l=(t.geometry.attributes.uv.itemSize,t.geometry.index.array),u=t.geometry.index.count;for(o=0;o<u;o++){var d=l[o],f=3*d,p=2*d;R.set(a[f],a[f+1],a[f+2]),t.localToWorld(R),s=1-T(R.y-i._offsetY,e.min.y,e.min.y+e.max.y*i._scaleShadow)/100,c[p]=s,c[p+1]=s}t.geometry.attributes.uv.needsUpdate=!0}}(t),t.userData.pos=s,t.userData.rot=n,t.userData.maxHeight=r,t.userData.scaleShadow=i._scaleShadow)}for(var h=0;h<t.children.length;h++)S(t.children[h])}function B(){_.scale.x=(i.boundingBoxUv.max.y||1)*i._scaleShadow,_.position.y=_.scale.x/2+i.boundingBoxUv.min.y;for(var t=0;t<i.arrShadowMesh.length;t++)(i._isDinamFotoRect||(c.setFromObject(i.arrShadowMesh[t]),H(c.min.x,c.min.z,c.max.x-c.min.x,c.max.z-c.min.z,i.fotoPosition.x,i.fotoPosition.y,i.fotoWH,i.fotoWH)))&&S(i.arrShadowMesh[t])}this.updateShadowUv=B,this.updateShadowTexture=function(){this.canvasGG.update(),this.textureShadow.needsUpdate=!0},this.setShadowColor=function(t,e,s){g.r=t,g.g=e,g.b=s,i.updateShadowTexture()},this.getConfig=function(){var t={};return t.imgWH=i.imgWH,t.fotoPosition={x:i._fotoPosition.x,y:i._fotoPosition.y},t.fotoWH=i.fotoWH,t.maxHeight=i.maxHeight,t.isDinamFotoRect=i.isDinamFotoRect,t.arrDataSempl=i.arrDataSempl,t.opacityMat=i.opacityMat,t.dunamic=i.dunamic,t.canvasGG={arrColorStopTranspanent:i.canvasGG.arrColorStopTranspanent,arrProcent:i.canvasGG.arrProcent},t},this.setConfig=function(t){i.canvasGG.arrColorStopTranspanent=t.canvasGG.arrColorStopTranspanent,i.canvasGG.arrProcent=t.canvasGG.arrProcent,i.fotoPosition.x=t.fotoPosition.x,i.fotoPosition.y=t.fotoPosition.y,i.fotoWH=t.fotoWH,i.isDinamFotoRect=t.isDinamFotoRect,i.arrDataSempl=t.arrDataSempl,i.opacityMat=t.opacityMat,i.imgWH=t.imgWH,i.dunamic=t.dunamic,i.updateShadowTexture(),i.maxHeight=t.maxHeight};var M={imgWH:1024,fotoPosition:{x:0,y:0},fotoWH:150,maxHeight:300,isDinamFotoRect:!1,arrDataSempl:[{min:0,max:6,blur:.8,alpha:.25},{min:4,max:15,blur:3,alpha:.64},{min:10,max:23,blur:4,alpha:.5},{min:15,max:50,blur:15,alpha:1},{min:20,max:198.09,blur:15,alpha:.7},{min:0,max:2,blur:1.02,alpha:1}],opacityMat:1,dunamic:!0,canvasGG:{arrColorStopTranspanent:[0,1,.25],arrProcent:[.4,1,.96]}};function H(t,i,e,s,n,r,h,o){return t<n+h&&i<r+o&&t+e>n&&i+s>r}function T(t,i,e,s){return i=null!=i?i:0,e=null!=e?e:100,s=s||100,isNaN(parseFloat(t))&&(t=i),t<i&&(t=i),t>e&&(t=e),t=Math.round(t*s)/s,i<0?100*(Math.abs(i)+t)/(Math.abs(i)+Math.abs(e)||1):100*(Math.abs(i)-t)/(Math.abs(i)-Math.abs(e)||1)}this.sss=M,this.setConfig(M),this.getBase64=function(){return i.render(),f.canvas.toDataURL()},this.debug=!1}function r(t,i,e,s){this.min=t||0,this.max=i||1,this.blur=e||0,this.alpha=s||1}function h(){var t=this,i=document.createElement(\"canvas\");this.canvas=i,i.width=256,i.height=256;var e=i.getContext(\"2d\"),s=new Image;this.b64=null,this._blur=0,this._blur1=1,this._alpha=1,this.image=new Image,this.setBase64=function(e,n){this.b64=e,(s=new Image).onload=function(){i.clearRect(0,0,i.width,i.height),i.width=s.width,i.height=s.height,t.update(),n&&n(i.toDataURL())},s.src=e},this.setCanvas=function(t){s=t,i.width=t.width,i.height=t.height},this.update=function(){e.filter=\"blur(\"+t._blur+\"px)\",e.globalAlpha=t._alpha,e.drawImage(s,0,0)}}function o(){var t=this,i=document.createElement(\"canvas\");i.width=i.height=256,this.canvas=i;var e=i.getContext(\"2d\");this._blur=0,this._alpha=1,this.arrColorStopTranspanent=[0,1],this.arrProcent=[0,1],this.position=new THREE.Vector2,this.position1=new THREE.Vector2(1,0),this.r=0,this.g=0,this.b=0,this.update=function(){var s=i.width,n=i.height;e.clearRect(0,0,s,n),e.rect(0,0,s,n),e.filter=\"blur(\"+t._blur+\"px)\",e.globalAlpha=t._alpha;for(var r=t.position.x*s,h=t.position.y*n,o=t.position1.x*s,a=t.position1.y*n,c=e.createLinearGradient(r,h,o,a),l=0;l<t.arrColorStopTranspanent.length;l++)c.addColorStop(t.arrProcent[l],\"rgba(\"+t.r+\",\"+t.g+\",\"+t.b+\",\"+t.arrColorStopTranspanent[l]+\")\");e.fillStyle=c,e.fill()},this.update()}function a(t){this.parent=t;this._active=!1,this._visible=!0,this.WH=512,this._wn=this.WH,this._obj3d=void 0,this.smc=void 0,this.init=function(){null==this.smc&&(this.smc=new n,this.smc.fotoPosition.set(-this._wn/2,-this._wn/2),this.smc.fotoWH=this._wn,this.smc.content3d.rotation.x=-Math.PI/2,this.smc.content3d.position.y=-1,this.smc.content3d.visible=this._visible,this.dergObj())},this.dergActiv=function(){1==this._active?null==this.smc.content3d.parent&&this.parent.parent.groupObject.add(this.smc.content3d):null!=this.smc.content3d.parent&&this.parent.parent.groupObject.remove(this.smc.content3d)},this.render=function(){null!=this.smc&&null!=this.smc.content3d.parent&&this.smc.upDate()},this.dergObj=function(){null!=this.smc&&(null!=this._obj3d?this.smc.arrObj[0]==this._obj3d||(this.smc.clear(),this.smc.addObj(this._obj3d)):this.smc.clear())}}Object.defineProperties(n.prototype,{scaleShadow:{set:function(t){this.dirty=!0,this._scaleShadow=t},get:function(){return this._scaleShadow}},debug:{set:function(t){this.helpers.visible=t},get:function(){return this.helpers.visible}},offsetY:{set:function(t){this._offsetY=t,this.dirty=!0},get:function(){return this._offsetY}},maxHeight:{set:function(t){this.dirty=!0,this.boundingBoxUv.max.y=t,this.updateShadowUv()},get:function(){return this.boundingBoxUv.max.y}},dunamic:{set:function(t){this.dirty=!0,this._dunamic=t},get:function(){return this._dunamic}},fotoPosition:{set:function(t){this.dirty=!0,this._fotoPosition=t},get:function(){return this._fotoPosition}},fotoWH:{set:function(t){this.dirty=!0,this._fotoWH=t},get:function(){return this._fotoWH}},imgWH:{set:function(t){this.dirty=!0,this._imgWH=t},get:function(){return this._imgWH}},imgBlur:{set:function(t){this.dirty=!0,this._imgBlur=t},get:function(){return this.dirty=!0,this._imgBlur}},imgAlpha:{set:function(t){this.dirty=!0,this._imgAlpha=t},get:function(){return this._imgAlpha}},isDinamFotoRect:{set:function(t){this.dirty=!0,this._isDinamFotoRect=t},get:function(){return this._isDinamFotoRect}},opacityMat:{set:function(t){this.dirty=!0,this._opacityMat=t,this.matPlan.opacity=this._opacityMat},get:function(){return this._opacityMat}},shadowMaterial:{set:function(t){if(t!==this._shadowMaterial){this._shadowMaterial=t;for(var i=0;i<this.arrShadowMesh.length;i++)if(this.arrShadowMesh[i]instanceof THREE.ShadowMesh)this.arrShadowMesh[i].material=this._shadowMaterial;else for(var e=0;e<this.arrShadowMesh[i].children.length;e++)this.arrShadowMesh[i].children[e]instanceof THREE.ShadowMesh&&(this.arrShadowMesh[i].children[e].material=this._shadowMaterial)}},get:function(){return this._shadowMaterial}},lightPosition4D:{set:function(t){this._lightPosition4D.set(t.x,t.y,t.z,.001)},get:function(){return this._lightPosition4D}}}),Object.defineProperties(h.prototype,{blur:{set:function(t){this._blur=t},get:function(){return this._blur}},alpha:{set:function(t){this._alpha=t},get:function(){return this._alpha}}}),Object.defineProperties(o.prototype,{}),e.d(i,\"a\",function(){return a}),a.prototype={set active(t){this._active!==t&&(this._active=t,this.init(),this.dergActiv())},get active(){return this._active},set visible(t){this._visible!==t&&(this._visible=t,null!=this.smc&&(this.smc.content3d.visible=t))},get visible(){return this._visible},set obj3d(t){this._obj3d!==t&&(this._obj3d=t,this.dergObj())},get obj3d(){return this._obj3d},set wh(t){this._wh!==t&&(this._wh=t,null!=this.smc&&(this.smc.fotoPosition.set(-this._wn/2,-this._wn/2),this.smc.fotoWH=this._wn))},get wh(){return this._wh}}},function(t,i,e){\"use strict\";var s=e(0),n=e(2);function r(t){var i=this;this.visi3D=t,this.box3=new THREE.Box3,this.rectScreen=new Rectangle,this.world=new Rectangle(0,0,100,100),this.targetObject=null,this.arrPoint=[],this.isMoveCam=!1,this.isFromGeometry=!1,this._offset=0,this._active=!0,this._debug=!1;var e=new THREE.Vector2,s=new THREE.Vector2,n=new THREE.Vector3;function r(){i.zumeVisi3D(),e.set(i.world.x+i.world.width/2,i.world.y+i.world.height/2),s.set(i.rectScreen.x+i.rectScreen.width/2,i.rectScreen.y+i.rectScreen.height/2),e.sub(s).divideScalar(2)}this.upDate=function(){if(i.active&&(this.updateBound3d(),!i.box3.isEmpty())){if(this.visi3D.xVerh=n.x,this.visi3D.zVerh=n.z,this.visi3D.yVerh=-n.y,i.zumeVisi3D(),i.isMoveCam){r();for(var t=0;e.length()>2&&++t<10;)this.visi3D.position3d.moveCamXY(e),r()}i.debugFocus&&i.debugFocus.upDate()}},this.zumeVisi3D=function(){for(var t,e,s=0,n=6e4,r=0;s<n&&!(++r>20)&&(e=t=(s+n)/2,i.visi3D.zume=e,!(Math.abs(s-t)<.01||Math.abs(n-t)<.01||t<.01));)i.updateRectScreen(),i.isZoomIn()?n=t:s=t+1},this.updateBound3d=function(){if(i.box3.makeEmpty(),i.targetObject)i.box3.copy(i.getCompoundBoundingBox(i.targetObject));else for(var t=0;t<i.arrPoint.length;t++)i.box3.expandByPoint(i.arrPoint[t]);i.box3.getCenter(n)},this.updateRectScreen=function(){if(this.visi3D.camera.updateMatrixWorld(),this.visi3D.scene.updateMatrixWorld(),i.targetObject&&i.isFromGeometry){var t=i.getBoxObject(i.targetObject);i.box3.copy(t.box3),i.box3.getCenter(n),i.setRectFromBox(i.rectScreen,t.box2)}else i.setRectFromBox(i.rectScreen,i.boxToScreen(i.box3));i.updateWorldSize()},this.setRectFromBox=function(t,i){t.x=i.min.x,t.y=i.min.y,t.width=i.max.x-i.min.x,t.height=i.max.y-i.min.y},this.getCompoundBoundingBox=function(){var t=new THREE.Box3,i=new THREE.Box3;function e(e){var s=e.geometry;void 0!==s&&(s.boundingBox||s.computeBoundingBox(),i.copy(s.boundingBox),i.applyMatrix4(e.matrixWorld),t.union(i))}return function(i){return i.updateMatrixWorld(!0),t.makeEmpty(),i.traverseVisible(e),t}}(),this.boxToScreen=function(){for(var t=new THREE.Box2,e=[],s=0;s<8;s++)e[s]=new THREE.Vector3;return function(s){t.makeEmpty(),e[0].set(s.min.x,s.min.y,s.min.z),e[1].set(s.min.x,s.max.y,s.min.z),e[2].set(s.max.x,s.min.y,s.min.z),e[3].set(s.max.x,s.max.y,s.min.z),e[4].set(s.min.x,s.min.y,s.max.z),e[5].set(s.min.x,s.max.y,s.max.z),e[6].set(s.max.x,s.min.y,s.max.z),e[7].set(s.max.x,s.max.y,s.max.z);for(var n=0;n<e.length;n++)t.expandByPoint(i.toScreenXY(e[n]));return t}}(),this.getBoxObject=function(){var t,e,s=new THREE.Box2,n=new THREE.Box3,r={box2:s,box3:n},h=new THREE.Vector3;function o(r){var o=r.geometry;if(void 0!==o)if(o.isGeometry){var a=o.vertices;for(t=0,e=a.length;t<e;t++)h.copy(a[t]).applyMatrix4(r.matrixWorld),n.expandByPoint(h),s.expandByPoint(i.toScreenXY(h))}else if(o.isBufferGeometry){var c=o.attributes.position;if(void 0!==c)for(t=0,e=c.count;t<e;t++)h.fromBufferAttribute(c,t).applyMatrix4(r.matrixWorld),n.expandByPoint(h),s.expandByPoint(i.toScreenXY(h))}}return function(t){return t.updateMatrixWorld(!0),s.makeEmpty(),n.makeEmpty(),t.traverseVisible(o),r}}();var h=new THREE.Vector2,o=new THREE.Vector3;this.toScreenXY=function(t){return o.copy(t),o.project(i.visi3D.camera),h.x=Math.round((o.x+1)*i.visi3D._width/2),h.y=Math.round((1-o.y)*i.visi3D._height/2),h},this.updateWorldSize=function(){i.world.x=i.offset,i.world.y=i.offset,i.world.width=this.visi3D._width-2*i.offset,i.world.height=this.visi3D._height-2*i.offset},this.isZoomIn=function(){return i.rectScreen.x>i.world.x&&i.rectScreen.x+i.rectScreen.width<i.world.x+i.world.width&&i.rectScreen.y>i.world.y&&i.rectScreen.y+i.rectScreen.height<i.world.y+i.world.height}}function h(t){var i=this;this.mFocus=t;var e=visi3D.scene,s=main.stage,n=new BoxHelper(1,materialAlphaRed);e.add(n);var r=new PIXI.Graphics;r.hitArea=new PIXI.Rectangle(0,0,0,0),s.addChild(r),i.active=!1,n.visible=r.visible=i.active,this.upDate=function(){n.visible=r.visible=i.active,i.active&&(r.clear(),r.position.set(visi3D._x,visi3D._y),r.lineStyle(1,0,1),r.drawRect(t.world.x,t.world.y,t.world.width,t.world.height),r.lineStyle(1,16711680,1),r.drawRect(t.rectScreen.x,t.rectScreen.y,t.rectScreen.width,t.rectScreen.height),n.width=t.box3.max.x-t.box3.min.x,n.depth=t.box3.max.y-t.box3.min.y,n.height=t.box3.max.z-t.box3.min.z,t.box3.getCenter(n.position))}}function o(t){var i=this;this.parent=t,this._debug=!1,this.debugInit=!1,this.shadowHelper=void 0,this.spotLightHelper=void 0,this.gridHelper=void 0,this.FIXATION=!1,this.ROTATION_X=0,this.ROTATION_Z=0,this.DISTANCE=this.parent.DISTANCE,this.CUB_HEIGHT=this.parent.CUB_HEIGHT,this.CUB_WIDTH=this.parent.CUB_WIDTH,this.SKY_X=0,this.SKY_Y=0,this.SKY_Z=0,this._fixation=this.FIXATION,this._rotationX=this.ROTATION_X,this._rotationZ=this.ROTATION_Z,this._distance=this.DISTANCE,this._cubHeight=this.CUB_HEIGHT,this._cubWidth=this.CUB_WIDTH,this.sky=new s.a(this),this.smc=new n.a(this),this.focus=new r(this.parent),this.funDebug=function(){1!=this.debugInit&&(this.debugInit=!0,this.plane=new THREE.Mesh(new THREE.PlaneBufferGeometry(1e3,1e3).rotateX(-Math.PI),new THREE.MeshLambertMaterial({color:new THREE.Color(11316396)})),this.plane.castShadow=this.plane.receiveShadow=!0,this.gridHelper=new THREE.GridHelper(1e3,10),this.gridHelper.rotation.x=-Math.PI/2,this.shadowHelper=new THREE.CameraHelper(this.parent.sunLight.shadow.camera),this.parent.sunLight&&(this.spotLightHelper=new THREE.DirectionalLightHelper(this.parent.sunLight))),1==this._debug?(null==this.gridHelper.parent&&this.parent.groupObject.add(this.gridHelper),null==this.plane.parent&&this.parent.groupObject.add(this.plane),null==this.shadowHelper.parent&&this.parent.scene.add(this.shadowHelper),this.parent.sunLight&&(null!=this.parent.sunLight.parent||(null!=this.spotLightHelper.parent&&this.parent.scene.remove(this.spotLightHelper),null!=this.shadowHelper.parent&&this.parent.scene.remove(this.shadowHelper)))):(null!=this.gridHelper.parent&&this.parent.groupObject.remove(this.gridHelper),null!=this.plane.parent&&this.parent.groupObject.remove(this.plane),null!=this.shadowHelper.parent&&this.parent.scene.remove(this.shadowHelper),this.parent.sunLight&&null!=this.spotLightHelper.parent&&this.parent.scene.remove(this.spotLightHelper))},this.render=function(){1==this._debug&&null!=this.spotLightHelper&&this.spotLightHelper.update(),this.smc.render(),this.sky.render(),this.focus.upDate(),this.dragSunLight()};var e=0;this.dragSunLight=function(){var t;null!=this.parent.sunLight&&(null!=this.parent.sunLight.parent&&(!0===i._fixation?(e=this._distance+2*this._cubHeight,i.parent.sunLight.position.set(0,e,0),i.parent.sunLight.position.applyAxisAngle(new THREE.Vector3(1,0,0),i._rotationX),i.parent.sunLight.position.applyAxisAngle(new THREE.Vector3(0,1,0),i._rotationZ-i.parent._rotationZ)):(e=this._distance+this._cubHeight,this.parent.sunLight.position.set(0,e,0),this.parent.sunLight.position.applyAxisAngle(new THREE.Vector3(1,0,0),this._rotationX),this.parent.sunLight.position.applyAxisAngle(new THREE.Vector3(0,1,0),this._rotationZ),this.parent.staticShadow&&(t=new THREE.Vector3(i.parent.xVerh,i.parent.yVerh,i.parent.zVerh),i.parent.sunLight.position.add(t),i.parent.sunLight.target.position.copy(t),h.distanceTo(t)>i.distanceUpdateShadow&&(h.copy(t),i.parent.shadowNeedsUpdate=!0)))))};var h=new THREE.Vector3;this.distanceUpdateShadow=500,this.dragSunLight2=function(){null!=this.parent.sunLight&&null!=this.parent.sunLight.parent&&(!0===this._fixation||(e=this._distance+2*this._cubHeight,this.parent.sunLight.position.set(0,e,0),this.parent.sunLight.position.applyAxisAngle(new THREE.Vector3(1,0,0),this._rotationX),this.parent.sunLight.position.applyAxisAngle(new THREE.Vector3(0,1,0),this._rotationZ)))},this.dragSunLight3=function(){this.parent.sunLight&&(this.parent.sunLight.shadow.camera.near=0+this._cubHeight,this.parent.sunLight.shadow.camera.far=2*this._cubHeight+this._cubHeight,this.parent.sunLight.shadow.camera.updateProjectionMatrix(),this.shadowHelper&&this.shadowHelper.update())},this.sunActiv=function(t){this.parent.objShadow(this.parent.group,t),1==t?null==this.parent.sunLight.parent&&(this.parent.scene.add(this.parent.sunLight),this.parent.scene.add(i.parent.sunLight.target)):null!=this.parent.sunLight.parent&&(this.parent.scene.remove(this.parent.sunLight),this.parent.scene.remove(i.parent.sunLight.target)),this.funDebug()},this.ambientActiv=function(t){1==t?null==this.parent.ambientLight.parent&&this.parent.scene.add(this.parent.ambientLight):null!=this.parent.ambientLight.parent&&this.parent.scene.remove(this.parent.ambientLight)}}r.prototype={set offset(t){this._offset=t||0},get offset(){return this._offset},set debug(t){this._debug=t,t&&!this.debugFocus&&(this.debugFocus=new h(this)),this.debugFocus&&(this.debugFocus.active=t)},get debug(){return this._debug},set active(t){this._active=t,t||(this.debug=!1)},get active(){return this._active}},e.d(i,\"a\",function(){return o}),o.prototype={set debug(t){this._debug!==t&&(this._debug=t,this.funDebug())},get debug(){return this._debug},set rotationX(t){this._rotationX!==t&&(this._rotationX=t,null!=this.spotLightHelper&&(this.parent.sunLight.shadow.camera.updateProjectionMatrix(),this.spotLightHelper.update()),this.dragSunLight2())},get rotationX(){return this._rotationX},set rotationZ(t){this._rotationZ!==t&&(this._rotationZ=t,this.sky.shadRotZ=t,null!=this.spotLightHelper&&this.spotLightHelper.update(),this.dragSunLight2())},get rotationZ(){return this._rotationZ},set fixation(t){this._fixation!==t&&(this._fixation=t,this.dragSunLight2())},get fixation(){return this._fixation},set distance(t){this._distance!==t&&(this._distance=t,this.dragSunLight3(),this.dragSunLight2())},get distance(){return this._distance},set cubHeight(t){this._cubHeight!==t&&(this._cubHeight=t,this.dragSunLight3(),this.dragSunLight2())},get cubHeight(){return this._cubHeight},set cubWidth(t){this._cubWidth!==t&&(this._cubWidth=t,this.parent.sunLight&&(this.parent.sunLight.shadow.camera.right=this._cubWidth,this.parent.sunLight.shadow.camera.left=-this._cubWidth,this.parent.sunLight.shadow.camera.top=this._cubWidth,this.parent.sunLight.shadow.camera.bottom=-this._cubWidth,this.parent.sunLight.shadow.camera.updateProjectionMatrix(),this.shadowHelper&&this.shadowHelper.update()))},get cubWidth(){return this._cubWidth}}},function(module,__webpack_exports__,__webpack_require__){\"use strict\";__webpack_require__.d(__webpack_exports__,\"a\",function(){return MVisi3D});var _MEffectArray_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(5),_MPosition3d_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(6),_MEvent3DArr_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(7),_MUtility_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(3);function MVisi3D(_contentHTML,_content2d,_devas,_directional,_efect,_event3DArr,_alpha){var self=this;_devas=void 0!==_devas&&_devas,_directional=void 0===_directional||_directional,_efect=void 0===_efect||_efect,_event3DArr=void 0===_event3DArr||_event3DArr,_alpha=void 0!==_alpha&&_alpha,this.intRend=0,this.devas=_devas,this.arrSetiScene=[],this._xVerh=0,this._yVerh=0,this._zVerh=0,this._rotationX=0,this._rotationZ=0,this._zume=1e3,this._arrOut=[],this._x=0,this._y=0,this._height=100,this._width=100,this.yes3d=!0,this.intRendOk=1,this._visible=!0,this._isDragPan=!1,this._activMouse=!0,this._staticShadow=!1,this.alwaysRender=!1,this.AMBIEN_COLOR=\"#ffffff\",this.AMBIEN_INTENSITY=.79,this.LIGHT_COLOR=\"#ffffff\",this.LIGHT_BIAS=.001,this.SHADOW_INTENSITY=.22,this.SHADOW_RADIUS=1,this.SHADOW_WH=4096,this.DISTANCE=0,this.CUB_HEIGHT=500,this.CUB_WIDTH=500,this.FOV=45,this.FAR=45e3,this.content=void 0,this.graphics=void 0,null!=_content2d&&(this.content=eval(\"new PIXI.Container()\"),this.graphics=eval(\"new PIXI.Graphics()\"),_content2d.addChild(this.content),this.content.addChild(this.graphics),this.graphics.interactive=!0),this.camera,this.scene=new THREE.Scene;var color=7978188;this.camera=new THREE.PerspectiveCamera(this.FOV,this._width/this._height,1,this.FAR),1==this.devas?(this.renderer=new THREE.WebGLRenderer,this.renderer.setSize(this._width,this._height),this.renderer.setClearColor(color,1)):(this.renderer=new THREE.WebGLRenderer({antialias:!0,alpha:_alpha}),this.renderer.shadowMap.enabled=!0,this.renderer.setSize(this._width,this._height),1==_alpha?this.renderer.setClearColor(color,0):this.renderer.setClearColor(color,1)),this.renderer.shadowMap.type=THREE.PCFSoftShadowMap,this.efect,1==_efect&&(this.efect=new _MEffectArray_js__WEBPACK_IMPORTED_MODULE_0__.a(this,[]),this.efect.init()),this.event3DArr,1==_event3DArr&&(this.event3DArr=new _MEvent3DArr_js__WEBPACK_IMPORTED_MODULE_2__.a(this,this.camera,this.renderer.domElement),this.scene.event3DArr=this.event3DArr,this.event3DArr.addDragEvent(this.graphics),this.event3DArr.activ=this._activMouse),this.camera.position.set(0,0,-60),this.camera.rotation.set(Math.PI,0,0),_contentHTML.appendChild(this.renderer.domElement),this.renderer.domElement.style.position=\"fixed\",this.renderer.domElement.style.top=\"0px\",this.renderer.domElement.style.left=\"0px\",this.group=new THREE.Object3D,this.group.rotation.x=Math.PI/2,this.scene.add(this.group),this.group1=new THREE.Object3D,this.group.add(this.group1),this.group2=new THREE.Object3D,this.group1.add(this.group2),this.groupObject=new THREE.Object3D,this.group2.add(this.groupObject),this.group3d=new THREE.Object3D,this.groupObject.add(this.group3d),this.gCGG=new THREE.Object3D,this.group.add(this.gCGG),this.gCAngel=new THREE.Object3D,this.gCGG.add(this.gCAngel),this.gCam1=new THREE.Object3D,this.gCAngel.add(this.gCam1),this.gCam2=new THREE.Object3D,this.gCam1.add(this.gCam2),this.ggCam=new THREE.Object3D,this.gCam2.add(this.ggCam),this.ggCam.add(this.camera),this.ggCam.position.z=-this._zume,this.camera.position.z=0,this.axesHelper=new THREE.AxesHelper(100),this.scene.add(this.axesHelper),this.axesHelper.visible=!1,this.arrPoint=[];var disLig=4e3,powerLig=.4,dis=1e4,bbbbbb;if(this.sunLight,this.ambientLight=new THREE.AmbientLight(this.AMBIEN_COLOR,this.AMBIEN_INTENSITY),this.scene.add(this.ambientLight),this.ambientLight.castShadow=!1,1==_directional){var sunIntensity=this.SHADOW_INTENSITY;this.sunLight=new THREE.DirectionalLight(this.LIGHT_COLOR,sunIntensity,0,0,.2),this.sunLight.position.set(0,this.DISTANCE+2*this.CUB_HEIGHT,0),this.sunLight.castShadow=!0,this.sunLight.shadow.camera.near=this.CUB_HEIGHT,this.sunLight.shadow.camera.far=this.CUB_HEIGHT+2*this.CUB_HEIGHT,this.sunLight.shadow.camera.right=this.CUB_WIDTH,this.sunLight.shadow.camera.left=-this.CUB_WIDTH,this.sunLight.shadow.camera.top=this.CUB_WIDTH,this.sunLight.shadow.camera.bottom=-this.CUB_WIDTH,this.sunLight.shadow.mapSize.width=this.SHADOW_WH,this.sunLight.shadow.mapSize.height=this.SHADOW_WH,this.sunLight.shadow.bias=this.LIGHT_BIAS,this.sunLight.shadow.radius=this.SHADOW_RADIUS}this.initOut=function(){},this.position3d=new _MPosition3d_js__WEBPACK_IMPORTED_MODULE_1__.a(self,this.graphics),this.utility=new _MUtility_js__WEBPACK_IMPORTED_MODULE_3__.a(self),this.arrayDoRender=[],this.shadowNeedsUpdate=!1,this.render=function(){if(0!=this.yes3d&&(this.utility.render(),this.intRend=10,this.shadowNeedsUpdate&&(this.shadowNeedsUpdate=!1,this.renderer.shadowMap.needsUpdate=!0),this.efect?0==this.efect.render()&&this.renderer.render(this.scene,this.camera):this.renderer.render(this.scene,this.camera),0!=this.arrayDoRender.length))for(var t=0;t<this.arrayDoRender.length;t++)this.arrayDoRender[t]()},this.upDate=function(){(this.alwaysRender||this.intRend==this.intRendOk)&&this.render(),this.intRend<10&&this.intRend++},this.renderer.render(this.scene,this.camera),this.sizeWindow=function(t,i,e,s){null!=t&&(this._x=t),null!=i&&(this._y=i),null!=s&&(this._height=s),null!=e&&(this._width=e),null!=this.content&&(this.content.x=this._x,this.content.y=this._y,this.graphics.clear(),this.graphics.beginFill(16711680,0),this.graphics.drawRect(0,0,this._width,this._height),this.graphics.endFill()),this.renderer.domElement.style.left=this._x+\"px\",this.renderer.domElement.style.top=this._y+\"px\",this.camera.aspect=this._width/this._height,this.camera.updateProjectionMatrix(),this.renderer.setSize(this._width,this._height),this.intRend=1,this.event3DArr&&(this.event3DArr.sizeWindow(this._width,this._height),this.event3DArr.setRect(this._x,this._y,this._width,this._height)),this.efect&&this.efect.sizeWindow(this._width,this._height)},this.render(),this.sizeWindow(),this.objShadow=function(t,i){if(1!=this.devas.devas)if(0!=this.devas.webGL){if(null==i&&(i=!0),bbbbbb=!0,t.material&&1==t.material.transparent&&t.material.opacity<1&&(bbbbbb=!1),1==bbbbbb&&(t.castShadow=i,t.receiveShadow=i),null!=t.children)for(var e=0;e<t.children.length;e++)null!=t.children?this.objShadow(t.children[e],i):(bbbbbb=!0,t.children[e].material&&1==t.material.transparent&&t.material.opacity<1&&(bbbbbb=!1),1==bbbbbb&&(t.children[e].castShadow=i,t.children[e].receiveShadow=i))}else i=!1;else i=!1},this.addEvent=function(t,i){this.event3DArr&&this.event3DArr.eventSob.addEvent(t,i)},this.removeEvent=function(t,i){this.event3DArr&&this.event3DArr.eventSob.removeEvent(t,i)},this.addChildMouse=function(t){this.event3DArr&&this.event3DArr.addChild(t)},this.removeChildMouse=function(t){this.event3DArr&&this.event3DArr.removeChild(t)}}MVisi3D.prototype={set staticShadow(t){this.renderer.shadowMap.autoUpdate=!t,this._staticShadow=t},get staticShadow(){return this._staticShadow},set rotationX(t){this._rotationX!==t&&(this._rotationX=t,this.intRend=1,this.gCam2.rotation.x=t)},get rotationX(){return this._rotationX},set rotationZ(t){this._rotationZ!==t&&(this._rotationZ=t,this.gCam1.rotation.z=t,this.intRend=1)},get rotationZ(){return this._rotationZ},set zume(t){this._zume!==t&&(this._zume=t,this.ggCam.position.z=-t,this.camera.position.z=0,this.intRend=1)},get zume(){return this._zume},set yVerh(t){this._yVerh=t,this.gCGG.position.z=t,this.intRend=1},get yVerh(){return this.gCGG.position.z},set xVerh(t){this._xVerh=t,this.gCGG.position.x=t,this.intRend=1},get xVerh(){return this.gCGG.position.x},set zVerh(t){this._zVerh=t,this.gCGG.position.y=t,this.intRend=1},get zVerh(){return this.gCGG.position.y},set arrOut(t){this._arrOut=t,this.efect.setValue(\"outline\",null,this._arrOut),this.intRend=1},get arrOut(){return this._arrOut},set x(t){this._x=t,this.sizeWindow()},get x(){return this._x},set y(t){this._y=t,this.sizeWindow()},get y(){return this._y},set height(t){this._height=t,this.sizeWindow()},get height(){return this._height},set width(t){this._width=t,this.sizeWindow()},get width(){return this._width},set visible(t){this._visible=t,this.content.visible=t,this.renderer.domElement.style.visibility=t?\"visible\":\"hidden\"},get visible(){return this._visible},set isDragPan(t){this._isDragPan=t,this.position3d.isDragPan=t},get isDragPan(){return this._isDragPan},set activMouse(t){this._activMouse=t,this.event3DArr&&(this.event3DArr.activ=this._activMouse)},get activMouse(){return this._activMouse},set minZum(t){this.position3d.minZum=t},get minZum(){return this.position3d.minZum},set maxZum(t){this.position3d.maxZum=t},get maxZum(){return this.position3d.maxZum},set maxRotationX(t){this.position3d.minMaxX.x=t},get maxRotationX(){return this.position3d.minMaxX.x},set minRotationX(t){t<this.rotationX&&(this.rotationX=t),this.position3d.minMaxX.y=t},get minRotationX(){return this.position3d.minMaxX.y}}},function(t,i,e){\"use strict\";function s(t){return(s=\"function\"==typeof Symbol&&\"symbol\"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&\"function\"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?\"symbol\":typeof t})(t)}function n(t,i){var e=this;this.visi3D=t,this._startArray=[],this._width=t._width,this._height=t._height,this.scene=this.visi3D.scene,this.camera=this.visi3D.camera,this.renderer=this.visi3D.renderer,this.composer=new THREE.EffectComposer(this.renderer),this.RENDER_PASS=!1,this.OUTLINE_PASS=!1,this.OUTLINE_COLOR=\"#0000ff\",this.OUTLINE_COLOR1=\"#ff0000\",this.STRJSON='{\"edgeGlow\":0,\"usePatternTexture\":false,\"edgeThickness\":1,\"edgeStrength\":3,\"downSampleRatio\":2,\"pulsePeriod\":0}',this.SAOJSON='{\"saoBlur\":true,\"output\":0,\"saoBias\":0,\"saoBlurDepthCutoff\":0,\"saoBlurRadius\":8,\"saoBlurStdDev\":4,\"saoIntensity\":0.18,\"saoKernelRadius\":100,\"saoMinResolution\":0,\"saoScale\":11.58}',this.TAA_PASS=!1,this.SAMPLE_LEVEL=0,this.STEREO_PASS=!1,this.SHADER_PASS=!1,this.SAO_PASS=!1,this.SSAO_PASS=!1,this._renderPass=this.RENDER_PASS,this._outlinePass=this.OUTLINE_PASS,this._outlineColor=this.OUTLINE_COLOR,this._outlineColor1=this.OUTLINE_COLOR1,this._strJSON=this.STRJSON,this._taaPass=this.TAA_PASS,this._sampleLevel=this.SAMPLE_LEVEL,this._stereoPass=this.STEREO_PASS,this._shaderPass=this.SHADER_PASS,this._saoPass=this.SAO_PASS,this._saoJSON=this.SAOJSON,this.jsonCheck=function(t){if(null==t)return!1;if(\"string\"!=typeof t)return!1;if(-1==t.indexOf('\":'))return!1;if(-1==t.indexOf(\"}\"))return!1;if(\"null\"===t)return!1;try{JSON.parse(t)}catch(t){return!1}return!0},this.setObjInObj=function(t,i){if(0!=this.jsonCheck(i)){var e=JSON.parse(i);for(var n in e)for(var r in t)r==n&&(\"object\"==s(e[r])?this.setObjInObj(t[r],e[r]):t[r]=e[r])}},this.array=[],this.object={},this.init=function(){if(0==this.array.length){var t=0;this.array[t]=new r(new THREE.RenderPass(this.scene,this.camera)),this.array[t].type=\"RenderPass\",t++,this.array[t]=new r(new THREE.OutlinePass(new THREE.Vector2(this._width,this._height),this.scene,this.camera)),this.array[t].type=\"OutlinePass\",this.array[t].effect.visibleEdgeColor=new THREE.Color(this._outlineColor),this.array[t].effect.hiddenEdgeColor=new THREE.Color(this._outlineColor1),t++,this.array[t]=new r(new THREE.TAARenderPass(this.scene,this.camera)),this.array[t].type=\"TAARenderPass\",t++,this.array[t]=new r(new THREE.ShaderPass(THREE.FXAAShader)),this.array[t].type=\"ShaderPass\",this.array[t].effect.uniforms.resolution.value.set(1/this._width,1/this._height),this.array[t].sizeWindow=function(t,i){this.effect.uniforms.resolution.value.set(1/t,1/i)},t++;var i=this.camera.far,e=this.camera.near;this.camera.far=10,this.camera.near=3,this.array[t]=new r(new THREE.SAOPass(this.scene,this.camera,!0,!0)),this.array[t].type=\"SAOPass\",this.camera.far=i,this.camera.near=e,t++;for(var s=0;s<this.array.length;s++)this.object[this.array[s].type]=this.array[s];this.setObjInObj(this.object.SAOPass.effect.params,this._saoJSON),this.setObjInObj(this.object.OutlinePass.effect,this._strJSON),this.sizeWindow(this._width,this._height)}};this.setValue=function(t,i,e){\"outline\"==t&&1==this.object.OutlinePass.activ&&(this.object.OutlinePass.effect.selectedObjects=e)},this.drawRender=function(){this.clear(),1==this._renderPass&&(this.object.RenderPass.activ=!0,this.clear(!0),this.object.RenderPass.effect.renderToScreen=!0,this.composer.addPass(this.object.RenderPass.effect)),1==this._outlinePass&&(this.object.OutlinePass.activ=!0,this.composer.addPass(this.object.OutlinePass.effect)),1==this._taaPass&&(this.object.TAARenderPass.activ=!0,this.clear(!0),this.object.TAARenderPass.effect.renderToScreen=!0,this.composer.addPass(this.object.TAARenderPass.effect)),1==this._shaderPass&&(this.object.ShaderPass.activ=!0,this.clear(!0),this.object.ShaderPass.effect.renderToScreen=!0,this.composer.addPass(this.object.ShaderPass.effect)),1==this._saoPass&&(this.object.SAOPass.activ=!0,this.clear(!0),this.object.SAOPass.effect.renderToScreen=!0,this.composer.addPass(this.object.SAOPass.effect)),1==this._ssaoPass&&(this.object.SSAOPass.activ=!0,this.clear(!0),this.object.SSAOPass.effect.renderToScreen=!0,this.composer.addPass(this.object.SSAOPass.effect))},this.redrag=function(){for(var t=[],i=1;i<e.array.length;i++)1==e.array[i].activ&&t.push(e.array[i].type);this.startArray=t},this.setArrayMash=function(t,i){};var n=!0;this.render=function(){if(n=!1,0!=this.array.length){for(var t=0;t<this.array.length;t++)0!=this.array[t]._activ&&(this.array[t].render(),n=!0);return 1==n&&this.composer.render(),n}},this.sizeWindow=function(t,i){if(this._width=t,this._height=i,0!=this.array.length){this.composer.setSize(this._width,this._height);for(var e=0;e<this.array.length;e++)this.array[e].sizeWindow&&this.array[e].sizeWindow(t,i)}},this.clear=function(t){null==t&&(this.composer.passes.length=0);for(var i=0;i<this.array.length;i++)null==t&&(this.array[i].activ=!1),this.array[i].effect.renderToScreen=!1,this.array[i].effect.unbiased=!1}}function r(t){this.type=\"null\",this.effect=t,this._activ=!1,this.render=function(){}}e.d(i,\"a\",function(){return n}),n.prototype={set activ(t){this._activ!=t&&(this._activ=t)},get activ(){return this._activ},set startArray(t){this._startArray=t},get startArray(){return this._startArray},set renderPass(t){this._renderPass!=t&&(this._renderPass=t,this.drawRender())},get renderPass(){return this._renderPass},set outlinePass(t){this._outlinePass!=t&&(this._outlinePass=t,this.drawRender())},get outlinePass(){return this._outlinePass},set outlineColor(t){this._outlineColor!=t&&(this._outlineColor=t,this.object.OutlinePass.effect.visibleEdgeColor=new THREE.Color(this._outlineColor),trace(this._outlineColor,\"   \",this.object.OutlinePass.effect.visibleEdgeColor))},get outlineColor(){return this._outlineColor},set outlineColor1(t){this._outlineColor1!=t&&(this._outlineColor1=t,this.object.OutlinePass.effect.hiddenEdgeColor=new THREE.Color(this._outlineColor1))},get outlineColor1(){return this._outlineColor1},set strJSON(t){this._strJSON!=t&&(this._strJSON=t,this.setObjInObj(this.object.OutlinePass.effect,this._strJSON))},get strJSON(){return this._strJSON},set taaPass(t){this._taaPass!=t&&(this._taaPass=t,this.drawRender())},get taaPass(){return this._taaPass},set sampleLevel(t){this._sampleLevel!=t&&(this._sampleLevel=t,this.object.TAARenderPass.effect.sampleLevel=this._sampleLevel)},get sampleLevel(){return this._sampleLevel},set shaderPass(t){this._shaderPass!=t&&(this._shaderPass=t,this.drawRender())},get shaderPass(){return this._shaderPass},set saoPass(t){this._saoPass!=t&&(this._saoPass=t,this.drawRender())},get saoPass(){return this._saoPass},set saoJSON(t){this._saoJSON!=t&&(this._saoJSON=t,this.setObjInObj(this.object.SAOPass.effect.params,this._saoJSON))},get saoJSON(){return this._saoJSON}},r.prototype={set activ(t){this._activ!=t&&(this._activ=t)},get activ(){return this._activ}},THREE.StereoEffect=function(t){var i=new THREE.StereoCamera;i.aspect=.5,this.setSize=function(i,e){t.setSize(i,e)},this.render=function(e,s){e.updateMatrixWorld(),null===s.parent&&s.updateMatrixWorld(),i.update(s);var n=t.getSize();t.setScissorTest(!0),t.clear(),t.setScissor(0,0,n.width/2,n.height),t.setViewport(0,0,n.width/2,n.height),t.render(e,i.cameraL),t.setScissor(n.width/2,0,n.width/2,n.height),t.setViewport(n.width/2,0,n.width/2,n.height),t.render(e,i.cameraR),t.setScissorTest(!1)}},THREE.PeppersGhostEffect=function(t){var i,e,s,n=this;n.cameraDistance=15,n.reflectFromAbove=!1;var r=new THREE.PerspectiveCamera,h=new THREE.PerspectiveCamera,o=new THREE.PerspectiveCamera,a=new THREE.PerspectiveCamera,c=new THREE.Vector3,l=new THREE.Quaternion,u=new THREE.Vector3;t.autoClear=!1,this.setSize=function(n,r){i=n/2,n<r?(e=n/3,s=n/3):(e=r/3,s=r/3),t.setSize(n,r)},this.render=function(d,f){d.updateMatrixWorld(),null===f.parent&&f.updateMatrixWorld(),f.matrixWorld.decompose(c,l,u),r.position.copy(c),r.quaternion.copy(l),r.translateZ(n.cameraDistance),r.lookAt(d.position),h.position.copy(c),h.quaternion.copy(l),h.translateZ(-n.cameraDistance),h.lookAt(d.position),h.rotation.z+=Math.PI/180*180,o.position.copy(c),o.quaternion.copy(l),o.translateX(-n.cameraDistance),o.lookAt(d.position),o.rotation.x+=Math.PI/180*90,a.position.copy(c),a.quaternion.copy(l),a.translateX(n.cameraDistance),a.lookAt(d.position),a.rotation.x+=Math.PI/180*90,t.clear(),t.setScissorTest(!0),t.setScissor(i-e/2,2*s,e,s),t.setViewport(i-e/2,2*s,e,s),n.reflectFromAbove?t.render(d,h):t.render(d,r),t.setScissor(i-e/2,0,e,s),t.setViewport(i-e/2,0,e,s),n.reflectFromAbove?t.render(d,r):t.render(d,h),t.setScissor(i-e/2-e,s,e,s),t.setViewport(i-e/2-e,s,e,s),n.reflectFromAbove?t.render(d,a):t.render(d,o),t.setScissor(i+e/2,s,e,s),t.setViewport(i+e/2,s,e,s),n.reflectFromAbove?t.render(d,o):t.render(d,a),t.setScissorTest(!1)}},THREE.ParallaxBarrierEffect=function(t){var i=new THREE.OrthographicCamera(-1,1,1,-1,0,1),e=new THREE.Scene,s=new THREE.StereoCamera,n={minFilter:THREE.LinearFilter,magFilter:THREE.NearestFilter,format:THREE.RGBAFormat},r=new THREE.WebGLRenderTarget(512,512,n),h=new THREE.WebGLRenderTarget(512,512,n),o=new THREE.ShaderMaterial({uniforms:{mapLeft:{type:\"t\",value:r.texture},mapRight:{type:\"t\",value:h.texture}},vertexShader:[\"varying vec2 vUv;\",\"void main() {\",\"\\tvUv = vec2( uv.x, uv.y );\",\"\\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\",\"}\"].join(\"\\n\"),fragmentShader:[\"uniform sampler2D mapLeft;\",\"uniform sampler2D mapRight;\",\"varying vec2 vUv;\",\"void main() {\",\"\\tvec2 uv = vUv;\",\"\\tif ( ( mod( gl_FragCoord.y, 2.0 ) ) > 1.00 ) {\",\"\\t\\tgl_FragColor = texture2D( mapLeft, uv );\",\"\\t} else {\",\"\\t\\tgl_FragColor = texture2D( mapRight, uv );\",\"\\t}\",\"}\"].join(\"\\n\")}),a=new THREE.Mesh(new THREE.PlaneBufferGeometry(2,2),o);e.add(a),this.setSize=function(i,e){t.setSize(i,e);var s=t.getPixelRatio();r.setSize(i*s,e*s),h.setSize(i*s,e*s)},this.render=function(n,o){n.updateMatrixWorld(),null===o.parent&&o.updateMatrixWorld(),s.update(o),t.render(n,s.cameraL,r,!0),t.render(n,s.cameraR,h,!0),t.render(e,i)}},THREE.AnaglyphEffect=function(t,i,e){this.colorMatrixLeft=(new THREE.Matrix3).fromArray([1.0671679973602295,-.0016435992438346148,.0001777536963345483,-.028107794001698494,-.00019593400065787137,-.0002875397040043026,-.04279090091586113,15809757314855233e-21,-.00024287120322696865]),this.colorMatrixRight=(new THREE.Matrix3).fromArray([-.0355340838432312,-.06440307199954987,.018319187685847282,-.10269022732973099,.8079727292060852,-.04835830628871918,.0001224992738571018,-.009558862075209618,.567823588848114]);var s=new THREE.OrthographicCamera(-1,1,1,-1,0,1),n=new THREE.Scene,r=new THREE.StereoCamera,h={minFilter:THREE.LinearFilter,magFilter:THREE.NearestFilter,format:THREE.RGBAFormat};void 0===i&&(i=512),void 0===e&&(e=512);var o=new THREE.WebGLRenderTarget(i,e,h),a=new THREE.WebGLRenderTarget(i,e,h),c=new THREE.ShaderMaterial({uniforms:{mapLeft:{type:\"t\",value:o.texture},mapRight:{type:\"t\",value:a.texture},colorMatrixLeft:{type:\"m3\",value:this.colorMatrixLeft},colorMatrixRight:{type:\"m3\",value:this.colorMatrixRight}},vertexShader:[\"varying vec2 vUv;\",\"void main() {\",\"\\tvUv = vec2( uv.x, uv.y );\",\"\\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\",\"}\"].join(\"\\n\"),fragmentShader:[\"uniform sampler2D mapLeft;\",\"uniform sampler2D mapRight;\",\"varying vec2 vUv;\",\"uniform mat3 colorMatrixLeft;\",\"uniform mat3 colorMatrixRight;\",\"float lin( float c ) {\",\"\\treturn c <= 0.04045 ? c * 0.0773993808 :\",\"\\t\\t\\tpow( c * 0.9478672986 + 0.0521327014, 2.4 );\",\"}\",\"vec4 lin( vec4 c ) {\",\"\\treturn vec4( lin( c.r ), lin( c.g ), lin( c.b ), c.a );\",\"}\",\"float dev( float c ) {\",\"\\treturn c <= 0.0031308 ? c * 12.92\",\"\\t\\t\\t: pow( c, 0.41666 ) * 1.055 - 0.055;\",\"}\",\"void main() {\",\"\\tvec2 uv = vUv;\",\"\\tvec4 colorL = lin( texture2D( mapLeft, uv ) );\",\"\\tvec4 colorR = lin( texture2D( mapRight, uv ) );\",\"\\tvec3 color = clamp(\",\"\\t\\t\\tcolorMatrixLeft * colorL.rgb +\",\"\\t\\t\\tcolorMatrixRight * colorR.rgb, 0., 1. );\",\"\\tgl_FragColor = vec4(\",\"\\t\\t\\tdev( color.r ), dev( color.g ), dev( color.b ),\",\"\\t\\t\\tmax( colorL.a, colorR.a ) );\",\"}\"].join(\"\\n\")}),l=new THREE.Mesh(new THREE.PlaneBufferGeometry(2,2),c);n.add(l),this.setSize=function(i,e){t.setSize(i,e);var s=t.getPixelRatio();o.setSize(i*s,e*s),a.setSize(i*s,e*s)},this.render=function(i,e){i.updateMatrixWorld(),null===e.parent&&e.updateMatrixWorld(),r.update(e),t.render(i,r.cameraL,o,!0),t.render(i,r.cameraR,a,!0),t.render(n,s)},this.dispose=function(){o&&o.dispose(),a&&a.dispose()}},THREE.AsciiEffect=function(t,i,e){i=void 0===i?\" .:-=+*#%@\":i,e||(e={});var s,n,r=e.resolution?e.resolution:.15,h=e.scale?e.scale:1,o=!!e.color&&e.color,a=!!e.alpha&&e.alpha,c=!!e.block&&e.block,l=!!e.invert&&e.invert,u=document.createElement(\"div\");u.style.cursor=\"default\";var d,f,p,g=document.createElement(\"table\");u.appendChild(g),this.setSize=function(i,e){s=i,n=e,t.setSize(i,e),function(){d=Math.round(s*E),f=Math.round(n*E),_.width=d,_.height=f,(p=t.domElement).style.backgroundColor&&(g.rows[0].cells[0].style.backgroundColor=p.style.backgroundColor,g.rows[0].cells[0].style.color=p.style.color);g.cellSpacing=0,g.cellPadding=0;var i=g.style;i.display=\"inline\",i.width=Math.round(d/E*h)+\"px\",i.height=Math.round(f/E*h)+\"px\",i.whiteSpace=\"pre\",i.margin=\"0px\",i.padding=\"0px\",i.letterSpacing=S+\"px\",i.fontFamily=v,i.fontSize=P+\"px\",i.lineHeight=R+\"px\",i.textAlign=\"left\",i.textDecoration=\"none\"}()},this.render=function(i,e){t.render(i,e),function(t,i){w.clearRect(0,0,d,f),w.drawImage(m,0,0,d,f);for(var e=w.getImageData(0,0,d,f).data,s=\"\",n=0;n<f;n+=2){for(var r=0;r<d;r++){var h,u,p=4*(n*d+r),g=e[p],y=e[p+1],x=e[p+2],v=e[p+3];u=(.3*g+.59*y+.11*x)/255,0==v&&(u=1),h=Math.floor((1-u)*(b.length-1)),l&&(h=b.length-h-1);var _=b[h];void 0!==_&&\" \"!=_||(_=\"&nbsp;\"),s+=o?\"<span style='color:rgb(\"+g+\",\"+y+\",\"+x+\");\"+(c?\"background-color:rgb(\"+g+\",\"+y+\",\"+x+\");\":\"\")+(a?\"opacity:\"+v/255+\";\":\"\")+\"'>\"+_+\"</span>\":_}s+=\"<br/>\"}i.innerHTML=\"<tr><td>\"+s+\"</td></tr>\"}(0,g)},this.domElement=u;var y=\" .,:;i1tfLCG08@\".split(\"\"),x=\" CGO08@\".split(\"\"),v=\"courier new, monospace\",m=t.domElement,_=document.createElement(\"canvas\");if(_.getContext){var w=_.getContext(\"2d\");if(w.getImageData){var b=o?x:y;i&&(b=i);var E=.5;E=.25,r&&(E=r);var P=2/E*h,R=2/E*h,S=0;switch(h){case 1:S=-1;break;case 2:case 3:S=-2.1;break;case 4:S=-3.1;break;case 5:S=-4.15}0}}},THREE.SSAARenderPass=function(t,i,e,s){THREE.Pass.call(this),this.scene=t,this.camera=i,this.sampleLevel=4,this.unbiased=!0,this.clearColor=void 0!==e?e:0,this.clearAlpha=void 0!==s?s:0,void 0===THREE.CopyShader&&console.error(\"THREE.SSAARenderPass relies on THREE.CopyShader\");var n=THREE.CopyShader;this.copyUniforms=THREE.UniformsUtils.clone(n.uniforms),this.copyMaterial=new THREE.ShaderMaterial({uniforms:this.copyUniforms,vertexShader:n.vertexShader,fragmentShader:n.fragmentShader,premultipliedAlpha:!0,transparent:!0,blending:THREE.AdditiveBlending,depthTest:!1,depthWrite:!1}),this.camera2=new THREE.OrthographicCamera(-1,1,1,-1,0,1),this.scene2=new THREE.Scene,this.quad2=new THREE.Mesh(new THREE.PlaneBufferGeometry(2,2),this.copyMaterial),this.quad2.frustumCulled=!1,this.scene2.add(this.quad2)},THREE.SSAARenderPass.prototype=Object.assign(Object.create(THREE.Pass.prototype),{constructor:THREE.SSAARenderPass,dispose:function(){this.sampleRenderTarget&&(this.sampleRenderTarget.dispose(),this.sampleRenderTarget=null)},setSize:function(t,i){this.sampleRenderTarget&&this.sampleRenderTarget.setSize(t,i)},render:function(t,i,e){this.sampleRenderTarget||(this.sampleRenderTarget=new THREE.WebGLRenderTarget(e.width,e.height,{minFilter:THREE.LinearFilter,magFilter:THREE.LinearFilter,format:THREE.RGBAFormat}),this.sampleRenderTarget.texture.name=\"SSAARenderPass.sample\");var s=THREE.SSAARenderPass.JitterVectors[Math.max(0,Math.min(this.sampleLevel,5))],n=t.autoClear;t.autoClear=!1;var r=t.getClearColor().getHex(),h=t.getClearAlpha(),o=1/s.length;this.copyUniforms.tDiffuse.value=this.sampleRenderTarget.texture;for(var a=e.width,c=e.height,l=0;l<s.length;l++){var u=s[l];this.camera.setViewOffset&&this.camera.setViewOffset(a,c,.0625*u[0],.0625*u[1],a,c);var d=o;if(this.unbiased)d+=1/32*((l+.5)/s.length-.5);this.copyUniforms.opacity.value=d,t.setClearColor(this.clearColor,this.clearAlpha),t.render(this.scene,this.camera,this.sampleRenderTarget,!0),0===l&&t.setClearColor(0,0),t.render(this.scene2,this.camera2,this.renderToScreen?null:i,0===l)}this.camera.clearViewOffset&&this.camera.clearViewOffset(),t.autoClear=n,t.setClearColor(r,h)}}),THREE.SSAARenderPass.JitterVectors=[[[0,0]],[[4,4],[-4,-4]],[[-2,-6],[6,-2],[-6,2],[2,6]],[[1,-3],[-1,3],[5,1],[-3,-5],[-5,5],[-7,-1],[3,7],[7,-7]],[[1,1],[-1,-3],[-3,2],[4,-1],[-5,-2],[2,5],[5,3],[3,-5],[-2,6],[0,-7],[-4,-6],[-6,4],[-8,0],[7,-4],[6,7],[-7,-8]],[[-4,-7],[-7,-5],[-3,-5],[-5,-4],[-1,-4],[-2,-2],[-6,-1],[-4,0],[-7,1],[-1,2],[-6,3],[-3,3],[-7,6],[-3,6],[-5,7],[-1,7],[5,-7],[1,-6],[6,-5],[4,-4],[2,-3],[7,-2],[1,-1],[4,-1],[2,1],[6,2],[0,4],[4,4],[2,5],[7,5],[5,6],[3,7]]],THREE.TAARenderPass=function(t,i,e){void 0===THREE.SSAARenderPass&&console.error(\"THREE.TAARenderPass relies on THREE.SSAARenderPass\"),THREE.SSAARenderPass.call(this,t,i,e),this.sampleLevel=0,this.accumulate=!1},THREE.TAARenderPass.JitterVectors=THREE.SSAARenderPass.JitterVectors,THREE.TAARenderPass.prototype=Object.assign(Object.create(THREE.SSAARenderPass.prototype),{constructor:THREE.TAARenderPass,render:function(t,i,e,s){if(!this.accumulate)return THREE.SSAARenderPass.prototype.render.call(this,t,i,e,s),void(this.accumulateIndex=-1);var n=THREE.TAARenderPass.JitterVectors[5];this.sampleRenderTarget||(this.sampleRenderTarget=new THREE.WebGLRenderTarget(e.width,e.height,this.params),this.sampleRenderTarget.texture.name=\"TAARenderPass.sample\"),this.holdRenderTarget||(this.holdRenderTarget=new THREE.WebGLRenderTarget(e.width,e.height,this.params),this.holdRenderTarget.texture.name=\"TAARenderPass.hold\"),this.accumulate&&-1===this.accumulateIndex&&(THREE.SSAARenderPass.prototype.render.call(this,t,this.holdRenderTarget,e,s),this.accumulateIndex=0);var r=t.autoClear;t.autoClear=!1;var h=1/n.length;if(this.accumulateIndex>=0&&this.accumulateIndex<n.length){this.copyUniforms.opacity.value=h,this.copyUniforms.tDiffuse.value=i.texture;for(var o=Math.pow(2,this.sampleLevel),a=0;a<o;a++){var c=n[this.accumulateIndex];if(this.camera.setViewOffset&&this.camera.setViewOffset(e.width,e.height,.0625*c[0],.0625*c[1],e.width,e.height),t.render(this.scene,this.camera,i,!0),t.render(this.scene2,this.camera2,this.sampleRenderTarget,0===this.accumulateIndex),this.accumulateIndex++,this.accumulateIndex>=n.length)break}this.camera.clearViewOffset&&this.camera.clearViewOffset()}var l=this.accumulateIndex*h;l>0&&(this.copyUniforms.opacity.value=1,this.copyUniforms.tDiffuse.value=this.sampleRenderTarget.texture,t.render(this.scene2,this.camera2,i,!0)),l<1&&(this.copyUniforms.opacity.value=1-l,this.copyUniforms.tDiffuse.value=this.holdRenderTarget.texture,t.render(this.scene2,this.camera2,i,0===l)),t.autoClear=r}})},function(t,i,e){\"use strict\";e.d(i,\"a\",function(){return s});e(3),e(0),e(2);function s(t,i){var e=this;this.parent=t,this.content2d=i,this.drag=!0,this.zdvigX=0,this.sPixi=void 0,this.pause=!1,this.minMaxX=new THREE.Vector2(0,2.5),this.zume=new THREE.Vector3(1,30,10),this.point=new THREE.Vector2(0,0),this.point1=new THREE.Vector2(0,0),this.b=0,this.minZum=0,this.maxZum=5e3,this.powerZum=5,this.distMinMaxBox=500,this.isDragPan=t._isDragPan,this.isRotateScene=!1;var s=0;this.getStage=function(t){return null==t.parent?t:this.getStage(t.parent)},this.stageMoveNew=function(t){if(1!=e.pause&&0!=e.drag){if(t.data&&e.isDragPan&&r)return i=t.data.originalEvent,a.set(i.clientX,i.clientY),c.subVectors(a,o),e.moveCamXY(c),void o.copy(a);var i;trace(t),t.data&&e.isRotateScene&&t.data.originalEvent.shiftKey?(e.parent.scene.rotation.y=s+.01*(pl102.global.x-e.point1.x),e.parent.intRend=1):(e.parent.rotationX=e.point.y-.01*(pl102.global.y-e.point1.y),e.minMaxX.x>e.parent.rotationX&&(e.parent.rotationX=e.minMaxX.x),e.minMaxX.y<e.parent.rotationX&&(e.parent.rotationX=e.minMaxX.y),e.parent.rotationZ=e.point.x+.01*(pl102.global.x-e.point1.x))}},this.stageUpNew=function(t){pl102.isMouseEvents&&(e.sPixi.off(\"mouseup\",e.stageUpNew),e.sPixi.off(\"mousemove\",e.stageMoveNew)),pl102.isTouchEvents&&(e.sPixi.off(\"touchend\",e.stageUpNew),e.sPixi.off(\"touchmove\",e.stageMoveNew))},this.mouseUpp=function(t){e.parent.intRend=1};var n,r=!1;this.mouseDown=function(t){var i;1!=e.pause&&(0!=e.drag&&(r=!1,e.isDragPan&&t&&1===t.data.originalEvent.button&&(r=!0,i=t.data.originalEvent,o.set(i.clientX,i.clientY)),e.point.y=e.parent.rotationX,e.point.x=e.parent.rotationZ,e.isRotateScene&&(s=e.parent.scene.rotation.y),e.point1.x=pl102.global.x,e.point1.y=pl102.global.y,pl102.isMouseEvents&&(e.sPixi.off(\"mouseup\",e.stageUpNew),e.sPixi.off(\"mousemove\",e.stageMoveNew),e.sPixi.on(\"mouseup\",e.stageUpNew),e.sPixi.on(\"mousemove\",e.stageMoveNew)),pl102.isTouchEvents&&(e.sPixi.off(\"touchend\",e.stageUpNew),e.sPixi.off(\"touchmove\",e.stageMoveNew),e.sPixi.on(\"touchend\",e.stageUpNew),e.sPixi.on(\"touchmove\",e.stageMoveNew))))},this.mousewheel=function(t){1!=e.pause&&0!=e.drag&&((n=e.parent._zume+-t.delta*e.powerZum)<e.minZum&&(n=e.minZum),n>e.maxZum&&(n=e.maxZum),e.parent.zume=n,e.parent.intRend=1)},null!=this.content2d&&(this.sPixi=this.getStage(this.content2d),this.sPixi.interactive=!0,0==pl102.devas?(i.on(\"mousedown\",this.mouseDown),pl102Wheel.on(i,\"mousewheel\",this.mousewheel)):i.on(\"touchstart\",this.mouseDown));var h=new THREE.Vector3,o=new THREE.Vector2,a=new THREE.Vector2,c=new THREE.Vector2;var l,u=(l=new THREE.Vector3,function(t,i){l.setFromMatrixColumn(i,0),l.multiplyScalar(-t),h.add(l)}),d=function(){var t=new THREE.Vector3;return function(i,e){t.setFromMatrixColumn(e,1),t.multiplyScalar(i),h.add(t)}}(),f=function(t,i){var s=e.parent.renderer.domElement;if(e.parent.camera.isPerspectiveCamera){var n=Math.max(e.parent.zume,10);n*=Math.tan(e.parent.camera.fov/2*Math.PI/180),u(2*t*n/s.clientHeight,e.parent.camera.matrixWorld),d(2*i*n/s.clientHeight,e.parent.camera.matrixWorld)}else console.warn(\"WARNING: camera neither perspective.\")};this.moveCamXY=function(t){h.set(0,0,0),e.parent.camera.updateMatrixWorld(),e.parent.scene.updateMatrixWorld(),arguments.length>1&&(t={x:arguments[0],y:arguments[1]}),f(t.x||0,t.y||0),e.parent.xVerh+=h.x,e.parent.yVerh+=-h.y,e.parent.zVerh+=h.z,e.parent.xVerh=Math.max(Math.min(e.parent.xVerh,e.distMinMaxBox),-e.distMinMaxBox),e.parent.zVerh=Math.max(Math.min(e.parent.zVerh,e.distMinMaxBox),-e.distMinMaxBox),e.parent.yVerh=Math.max(Math.min(e.parent.yVerh,e.distMinMaxBox),-e.distMinMaxBox),h.set(0,0,0)}}},function(t,i,e){\"use strict\";function s(){this.event=void 0,this.arrSobName=[\"up\",\"down\",\"move\",\"out\",\"over\",\"wheel\"],this.arrSob=[[],[],[],[],[],[]],this.pozSob=void 0,this.dispatcherEvent=function(t,i){for(var e=0;e<this.arrSobName.length;e++)if(this.arrSobName[e]==t){i&&(i.type=t);for(var s=0;s<this.arrSob[e].length;s++)this.arrSob[e][s](i)}},this.removeEvent=function(t,i){for(var e=0;e<this.arrSobName.length;e++)if(this.arrSobName[e]==t)for(var s=0;s<this.arrSob[e].length;s++)this.arrSob[e][s]==i&&this.arrSob[e].splice(s,1)},this.addEvent=function(t,i){for(var e=0;e<this.arrSobName.length;e++)this.arrSobName[e]==t&&this.arrSob[e].push(i)}}function n(){this.target=void 0,this.face=void 0,this.point=void 0,this.faceIndex=void 0,this.type=void 0,this.uv=void 0,this.originalEvent=void 0,this.copy=function(){var t=new Event3D;return t.target=this.target,t.face=this.face,t.point=this.point,t.faceIndex=this.faceIndex,t.type=this.type,t.uv=this.uv,t.originalEvent=this.originalEvent,t}}function r(t,i,e,r){this.parent=t;var h,o=this;this.camera=i,this.raycaster=new THREE.Raycaster,this.intersects,this.point=new THREE.Vector2(0,0),this.pointWH=new THREE.Vector2(0,0),this.arrChild=[],this.uuid=\"nullMy\",this.obj3d,this.eventSob=new s,this.event3D=new n,this.xzNull=\"xzNull\",this.poiskName=\"xzPoisk\",this.tokoName=\"null\",this._activ=!0,this.rect={x:0,y:0,width:100,height:100},this.setRect=function(t,i,e,s){this.rect.x=t,this.rect.y=i,this.rect.width=e,this.rect.height=s},this.removeChild=function(t){for(var i=0;i<this.arrChild.length;i++)t.uuid==this.arrChild[i].uuid&&(this.arrChild.splice(i,1),(i-=1)<0&&(i=0))},this.addChild=function(t){this.arrChild.push(t)},this.boolNum=-1,this.boolNumOld=-1,this.event,this.mouseRay=function(){0!=this._activ&&(this.rayPusk(),this.boolNum=this.getGoodParam(),-1==this.boolNum?\"nullMy\"!=this.uuid&&(this.eventSob.dispatcherEvent(\"out\",this.event3D),this.uuid=\"nullMy\"):\"nullMy\"!=this.uuid?this.uuid!=this.intersects[this.boolNum].object.uuid?(this.eventSob.dispatcherEvent(\"out\",this.event3D),this.uuid=this.intersects[this.boolNum].object.uuid,this.event3D.target=this.intersects[this.boolNum].object,this.event3D.face=this.intersects[this.boolNum].face,this.event3D.point=this.intersects[this.boolNum].point,this.event3D.faceIndex=this.intersects[this.boolNum].faceIndex,this.event3D.uv=this.intersects[this.boolNum].uv,this.event3D.originalEvent=o.event,this.eventSob.dispatcherEvent(\"over\",this.event3D)):(this.event3D.face=this.intersects[this.boolNum].face,this.event3D.point=this.intersects[this.boolNum].point,this.event3D.faceIndex=this.intersects[this.boolNum].faceIndex,this.event3D.uv=this.intersects[this.boolNum].uv,this.event3D.originalEvent=o.event,this.eventSob.dispatcherEvent(\"move\",this.event3D)):(this.uuid=this.intersects[this.boolNum].object.uuid,this.event3D.target=this.intersects[this.boolNum].object,this.event3D.face=this.intersects[this.boolNum].face,this.event3D.point=this.intersects[this.boolNum].point,this.event3D.faceIndex=this.intersects[this.boolNum].faceIndex,this.event3D.uv=this.intersects[this.boolNum].uv,this.event3D.originalEvent=o.event,this.eventSob.dispatcherEvent(\"over\",this.event3D)),this.boolNumOld=this.boolNum)},this.getPosition=function(t){var i=this.poiskName;if(this.poiskName=null!=t?t:\"xzPoisk\",this.restartPoint(),this.rayPusk(),this.poiskName=i,0!=this.intersects.length){var e=this.intersects.length-1;return-1==e&&(e=0),this.intersects[e]}return null};var a=new n;this.getNameEvent=function(t){if(this.restartPoint(),this.rayPusk(),0!=this.intersects.length)for(var i=0;i<this.intersects.length;i++)if(null!=this.intersects[i].object.parent&&this.intersects[i].object.name==t)return a.target=this.intersects[this.boolNum].object,a.face=this.intersects[this.boolNum].face,a.point=this.intersects[this.boolNum].point,a.faceIndex=this.intersects[this.boolNum].faceIndex,a.uv=this.intersects[this.boolNum].uv,a.originalEvent=o.event,a;return null},this.testVisiParam=function(t){return 0!=t.visible&&(null!=t.parent?this.testVisiParam(t.parent):\"Scene\"==t.type)},this.getGoodParam=function(){if(0!=this.intersects.length){var t;for(t=0;t<this.intersects.length;t++)0!=this.testVisiParam(this.intersects[t].object)&&null!=this.intersects[t].object.notActiv&&(this.intersects.splice(t,1),t=0);if(0==this.intersects.length)return-1;for(t=0;t<this.intersects.length;t++)if(0!=this.testVisiParam(this.intersects[t].object)&&this.intersects[t].object.name==this.poiskName)return t;for(t=0;t<this.intersects.length;t++)if(0!=this.testVisiParam(this.intersects[t].object)&&this.intersects[t].object.name!=this.xzNull)return t}return-1},this.rayPusk=function(){(h=new THREE.Vector3).setFromMatrixPosition(this.camera.matrixWorld),this.raycaster.ray.origin.copy(h),this.raycaster.ray.direction.set(this.point.x,this.point.y,.5).unproject(this.camera).sub(h).normalize(),this.intersects=this.raycaster.intersectObjects(this.arrChild,!0)},this.naCont=!1,this.mousemove=function(t){0!=o.naCont&&(null!=t.data?o.event=t.data.originalEvent:o.event=t,0!=o._activ&&(o.restartPoint(t),o.mouseRay(),o.intersects.length&&o.event.preventDefault()))},this.zdvigX=0,this.scale=1,this.pV=new THREE.Vector2(0,0),this.restartPoint=function(t){o.pV.x=pl102.global.x,o.pV.y=pl102.global.y,1==o.isRect(o.pV)?(o.point.x=-(this.rect.x-o.pV.x)/this.rect.width*2-1,o.point.y=-(-(this.rect.y-o.pV.y)/this.rect.height*2-1)):99999!=o.point.x&&(o.point.x=99999)},this.isRect=function(t){return t.x>=this.rect.x&&t.x<=this.rect.x+this.rect.width&&t.y>=this.rect.y&&t.y<=this.rect.y+this.rect.height},this.mouseup=function(t){null!=t.data?o.event=t.data.originalEvent:o.event=t,0!=o._activ&&(-1==o.boolNumOld?o.eventSob.dispatcherEvent(\"up\",null):(o.event3D.originalEvent=o.event,o.eventSob.dispatcherEvent(\"up\",o.event3D)),o.intersects.length&&o.event.preventDefault())},this.mousedown=function(t){null!=t.data?o.event=t.data.originalEvent:o.event=t,o.restartPoint(t),0!=o._activ&&(-1==o.boolNumOld?o.eventSob.dispatcherEvent(\"down\",null):(o.event3D.originalEvent=o.event,o.eventSob.dispatcherEvent(\"down\",o.event3D)),o.intersects.length&&o.event.preventDefault())},this.mouseout=function(t){o.naCont=!1,o.restartPoint(t),o.point.x=99999,o.mouseRay()},this.mouseover=function(t){o.naCont=!0,o.restartPoint(t),o.mouseRay()},this.mousewheel=function(t){null!=t.data?o.event=t.data.originalEvent:o.event=t,o.restartPoint(t),0!=o._activ&&(-1==o.boolNumOld?o.eventSob.dispatcherEvent(\"down\",null):(o.event3D.originalEvent=o.event,o.eventSob.dispatcherEvent(\"wheel\",t)))},this.addDragEvent=function(t){t.on(\"mousemove\",o.mousemove),t.on(\"mouseup\",o.mouseup),t.on(\"mousedown\",o.mousedown),t.on(\"mouseout\",o.mouseout),t.on(\"mouseover\",o.mouseover),pl102Wheel.on(t,\"mousewheel\",o.mousewheel)},this.removeDragEvent=function(t){t.off(\"mousemove\",o.mousemove),t.off(\"mouseup\",o.mouseup),t.off(\"mousedown\",o.mousedown),t.off(\"mouseout\",o.mouseout),t.off(\"mouseover\",o.mouseover),pl102Wheel.off(t,\"mousewheel\",o.mousewheel)},this.sizeWindow=function(t,i){this.pointWH.x=t,this.pointWH.y=i}}e.d(i,\"a\",function(){return r}),r.prototype={set activ(t){this._activ!=t&&(this._activ=t)},get activ(){return this._activ}}},function(t,i,e){\"use strict\";e.r(i),function(t){var s=e(1);e.d(i,\"LMain\",function(){return s.a}),t.LMain=s.a}.call(this,e(9))},function(t,i){var e;e=function(){return this}();try{e=e||new Function(\"return this\")()}catch(t){\"object\"==typeof window&&(e=window)}t.exports=e},function(t,i){}]);","extractedComments":[]}